<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">

<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">

<link rel="stylesheet" title="Default Style" href="styles/default/main.css" type="text/css">
<link rel="stylesheet" href="styles/default/xultu.css" type="text/css">


<link rel="stylesheet" href="styles/default/xultu-print.css" type="text/css" media="print">


<link rel="home"   href="http://www.xulplanet.com/"            title="http://www.XulPlanet.com/">
<link rel="search" href="http://www.xulplanet.com/cgi-bin/search/search.cgi" title="Search XulPlanet">
<link rel="author" href="http://www.xulplanet.com/ndeakin" title="Neil Deakin">
 <link rel="up" href="http://www.xulplanet.com/tutorials/" title="Up"> 
 <link rel="first" href="intro.html" title="First"> 
 <link rel="last" href="end.html" title="Last"> 

 <link rel="prev" href="focus.html"> 
 <link rel="next" href="commandupdate.html"> 

<meta name="Description" content="Step by step tutorial of the XML User Interface Language">

<title>XulPlanet.com - Commands</title>

</head>
<body>

<div id="header">
  <a href="http://www.xulplanet.com/">
    <img id="logo" src="images/xulplanet.png" width="215" height="65" alt="XUL Planet">
  </a>

<div id="locationlinks">
  <a href="http://www.xulplanet.com/">Home</a> &gt;

  <a href="http://www.xulplanet.com/tutorials/">Tutorials</a> :


  <a href="index.html">XUL Tutorial</a> :



 6.5 - Commands 
</div>



</div>



<hr class="edgesplit">

<div id="sidebar">

<div id="search">
  <form action="/cgi-bin/search/search.cgi" method="get">
    Search:<br>
    <input id="search-box" name="Terms" type="text">
    <input type="submit" value="Go">
  </form>
</div>

<hr>

<ul class="sidebar-section-links">
  <li><a href="http://www.xulplanet.com/tutorials/xultu/allofit.zip">Single Document Version</a></li>
  <li><a href="http://www.xulplanet.com/tutorials/xultu/xultu.zip">Download the XUL Tutorial</a><br></li>
  <li><a href="http://www.xulplanet.com/references/elemref/">Element Reference</a></li>
  <li><a href="http://www.xulplanet.com/references/elemref/quickref.html">Quick Reference</a><br></li>
  <li><a href="keyref.html">Key Code Reference</a></li>
  <li><a href="templateex.html">Template Syntax Examples</a></li>
</ul>

<hr>



<OL id="sidebar-docs-index">
  <LI class="sidebar-section-title">Introduction
  <OL>
    <LI> <A HREF="intro.html">Introduction</A></LI>
    <LI> <A HREF="xulfile.html">XUL Structure</A></LI>
    <LI> <A HREF="chromeurl.html">The Chrome URL</A></LI>
    <LI> <A HREF="packaging.html">Contents.rdf Files</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">Simple Elements
  <OL>
    <LI> <A HREF="window.html">Creating a Window</A></LI>
    <LI> <A HREF="buttons.html">Adding Buttons</A></LI>
    <LI> <A HREF="textimage.html">Adding Labels and Images</A></LI>
    <LI> <A HREF="inputs.html">Input Controls</A></LI>
    <LI> <A HREF="lists.html">List Controls</A></LI>
    <LI> <A HREF="progress.html">Progress Meters</A></LI>
    <LI> <A HREF="htmlelem.html">Adding HTML Elements</A></LI>
    <LI> <A HREF="springs.html">Using Spacers</A></LI>
    <LI> <A HREF="advbtns.html">More Button Features</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">The Box Model
  <OL>
    <LI> <A HREF="boxes.html">The Box Model</A></LI>
    <LI> <A HREF="boxstyle.html">Element Positioning</A></LI>
    <LI> <A HREF="boxdet.html">Box Model Details</A></LI>
    <LI> <A HREF="titledbox.html">Groupboxes</A></LI>
    <LI> <A HREF="boxfinal.html">Adding More Elements</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">More Layout Elements
  <OL>
    <LI> <A HREF="stacks.html">Stacks and Decks</A></LI>
    <LI> <A HREF="bulletins.html">Stack Positioning</A></LI>
    <LI> <A HREF="tabpanel.html">Tabboxes</A></LI>
    <LI> <A HREF="grids.html">Grids</A></LI>
    <LI> <A HREF="cpanels.html">Content Panels</A></LI>
    <LI> <A HREF="splitter.html">Splitters</A></LI>
    <LI> <A HREF="scroll.html">Scroll Bars</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">Toolbars and Menus
  <OL>
    <LI> <A HREF="toolbar.html">Toolbars</A></LI>
    <LI> <A HREF="menubar.html">Simple Menu Bars</A></LI>
    <LI> <A HREF="advmenu.html">More Menu Features</A></LI>
    <LI> <A HREF="popups.html">Popup Menus</A></LI>
    <LI> <A HREF="menuscroll.html">Scrolling Menus</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">Events and Scripts
  <OL>
    <LI> <A HREF="events.html">Adding Event Handlers</A></LI>
    <LI> <A HREF="advevents.html">More Event Handlers</A></LI>
    <LI> <A HREF="keyshort.html">Keyboard Shortcuts</A></LI>
    <LI> <A HREF="focus.html">Focus and Selection</A></LI>
    <LI> <SPAN CLASS="currentpage">Commands</SPAN></LI>
    <LI> <A HREF="commandupdate.html">Updating Commands</A></LI>
    <LI> <A HREF="broadob.html">Broadcasters and Observers</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">Document Object Model
  <OL>
    <LI> <A HREF="dom.html">Document Object Model</A></LI>
    <LI> <A HREF="dommodify.html">Modifying a XUL Interface</A></LI>
    <LI> <A HREF="domlists.html">Manipulating Lists</A></LI>
    <LI> <A HREF="boxobject.html">Box Objects</A></LI>
    <LI> <A HREF="xpcom.html">XPCOM Interfaces</A></LI>
    <LI> <A HREF="xpcomex.html">XPCOM Examples</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">Trees
  <OL>
    <LI> <A HREF="trees.html">Trees</A></LI>
    <LI> <A HREF="advtrees.html">More Tree Features</A></LI>
    <LI> <A HREF="seltree.html">Tree Selection</A></LI>
    <LI> <A HREF="treeview.html">Custom Tree Views</A></LI>
    <LI> <A HREF="treeviewdet.html">Tree View Details</A></LI>
    <LI> <A HREF="treeboxobject.html">Tree Box Objects</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">RDF and Templates
  <OL>
    <LI> <A HREF="intrordf.html">Introduction to RDF</A></LI>
    <LI> <A HREF="templates.html">Templates</A></LI>
    <LI> <A HREF="treetempl.html">Trees and Templates</A></LI>
    <LI> <A HREF="datasrc.html">RDF Datasources</A></LI>
    <LI> <A HREF="advrules.html">Advanced Rules</A></LI>
    <LI> <A HREF="persist.html">Persistent Data</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">Skins and Locales
  <OL>
    <LI> <A HREF="style.html">Adding Style Sheets</A></LI>
    <LI> <A HREF="treestyle.html">Styling a Tree</A></LI>
    <LI> <A HREF="defskin.html">Modifying the Default Skin</A></LI>
    <LI> <A HREF="cskin.html">Creating a Skin</A></LI>
    <LI> <A HREF="locale.html">Localization</A></LI>
    <LI> <A HREF="locprops.html">Property Files</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">Bindings
  <OL>
    <LI> <A HREF="introxbl.html">Introduction to XBL</A></LI>
    <LI> <A HREF="xblcontent.html">Anonymous Content</A></LI>
    <LI> <A HREF="xblatin.html">XBL Attribute Inheritance</A></LI>
    <LI> <A HREF="xblprops.html">Adding Properties</A></LI>
    <LI> <A HREF="xblmethods.html">Adding Methods</A></LI>
    <LI> <A HREF="xblevents.html">Adding Event Handlers</A></LI>
    <LI> <A HREF="xblinherit.html">XBL Inheritance</A></LI>
    <LI> <A HREF="xblex.html">XBL Example</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">Specialized Window Types
  <OL>
    <LI> <A HREF="featwin.html">Features of a Window</A></LI>
    <LI> <A HREF="dialogs.html">Creating Dialogs</A></LI>
    <LI> <A HREF="filedialog.html">Open and Save Dialogs</A></LI>
    <LI> <A HREF="wizard.html">Creating a Wizard</A></LI>
    <LI> <A HREF="advwiz.html">More Wizards</A></LI>
    <LI> <A HREF="overlay.html">Overlays</A></LI>
    <LI> <A HREF="crosspov.html">Cross Package Overlays</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">Installation
  <OL>
    <LI> <A HREF="xpinstall.html">Creating an Installer</A></LI>
    <LI> <A HREF="xpiscript.html">Install Scripts</A></LI>
    <LI> <A HREF="xpiadv.html">Additional Install Features</A></LI>
  </OL>
</OL>

</div>



<div id="content">

<div class="navlinks-pnc">

  <a class="prevlink" title="6.4 - Focus and Selection"
     href="focus.html">Previous</a>


  <a class="nextlink" title="6.6 - Updating Commands"
     href="commandupdate.html">Next</a>

</div>

<div class="xultu-content">

<h2>Commands</h2>

<P>
A command is an operation which may be invoked.
</P>

<H3>Command Elements</H3>

<P>
The <A CLASS="tag" HREF="elemref/ref_command.html">command</A> element is used to create commands
which can be used to carry out operations. You don't need to use commands,
since you can just call a script to handle things. However, a command has the
advantage that it can be disabled automatically when needed and can be invoked
externally without needing to know about the details of its implementation.
Commands provide a suitable way to abstract out operations from the code.
Commands become useful for larger applications.
</P>

<P>
For instance, in order to implement the clipboard menu commands, cut, copy and
paste, you can use commands. If you did not use commands, you would need to
figure out which field has the focus, then check to ensure that the operation
is suitable for that element. In addition, the menu commands would need to be
enabled and disabled depending on whether the focused element had selected
text or not, and for paste operations, whether there is something suitable on
the clipboard to paste. As you can see, this becomes complicated. By using
commands, much of the work is handled for you.
</P>

<P>
You can use a command for any operation. Mozilla uses them for almost every
menu command. In addition, text fields and other widgets have a number of
commands which they already support that you can invoke. You should use them
when the operation depends on which element is focused.
</P>

<P>
A command is identified by its <SPAN CLASS="attrib">id</SPAN> attribute.
Mozilla uses the convention that command id's start with 'cmd_'. You will
probably want to use the same id if a command is already being used, however,
for your own commands, you can use any command id you wish. To avoid
conflicts, you may wish to include the application name in the command id. A
simple way of using commands is as follows:
</P>


Example 6.5.1:
<A HREF='examples/ex_commands_1.xul.txt'>Source</A>
<A HREF="examples/ex_commands_1.xul" ONCLICK="window.open('examples/ex_commands_1.xul','xulex','chrome,resizable'); return false;">View</A>
<DIV CLASS="example"><PRE>&lt;command id="cmd_openhelp" oncommand="alert('Help!');"/&gt;
&lt;button label="Help" command="cmd_openhelp"/&gt;</PRE></DIV>



<P>
In this example, instead of placing the <SPAN CLASS="attrib">oncommand</SPAN>
attribute on the <A CLASS="tag" HREF="elemref/ref_button.html">button</A>, we instead place it on a
<A CLASS="tag" HREF="elemref/ref_command.html">command</A> element. The two are then linked using the
<SPAN CLASS="attrib">command</SPAN> attribute, which has the value of the
command's id. The result is that when the button is pressed, the command is
invoked.
</P>

<P>
There are two advantages to using this approach. First, it moves all your
operations onto commands which can all be grouped together in one section
of the XUL file. This means that code is all together and not scattered
throughout the UI code. The other advantage is that several buttons or other
UI elements can be hooked up to the same command. For instance, you might
have a menu item, a toolbar button and a keyboard shortuct all for the same
operation. Rather than repeat the code three times, you can hook all three up
to the same command. Normally, you would only hook up elements that would send
a command event.
</P>

<P>
If you set the <SPAN CLASS="attrib">disabled</SPAN> attribute on the command,
the command will be disabled and it will not be invoked. In addition, any
buttons and menu items hooked up to it will be disabled automatically. If you
re-enable the command, the buttons will become enabled again. 
</P>


Example 6.5.2:
<A HREF='examples/ex_commands_2.xul.txt'>Source</A>
<A HREF="examples/ex_commands_2.xul" ONCLICK="window.open('examples/ex_commands_2.xul','xulex','chrome,resizable'); return false;">View</A>
<DIV CLASS="example"><PRE>&lt;command id="cmd_openhelp" oncommand="alert('Help');"/&gt;
&lt;button label="Help" command="cmd_openhelp"/&gt;
&lt;button label="More Help" command="cmd_openhelp"/&gt;

&lt;button label="Disable"
        oncommand="document.getElementById('cmd_openhelp').setAttribute('disabled','true');"/&gt;
&lt;button label="Enable"
        oncommand="document.getElementById('cmd_openhelp').removeAttribute('disabled');"/&gt;</PRE></DIV>



<P>
In this example, both buttons use the same command. When the Disable button is
pressed, the command is disabled by setting its
<SPAN CLASS="attrib">disabled</SPAN> attribute, and both buttons will be
disabled as well.
</P>

<P>
It is normal to put a group of commands inside a
<A CLASS="tag" HREF="elemref/ref_commandset.html">commandset</A> element, together near the top of the XUL
file, as in the following:
</P>


<DIV CLASS="sample"><PRE>&lt;commandset&gt;
  &lt;command id="cmd_open" oncommand="alert('Open!');"/&gt;
  &lt;command id="cmd_help" oncommand="alert('Help!');"/&gt;
&lt;/commandset&gt;</PRE></DIV>



<P>
A command is invoked when the user activates the button or other element
attached to the command. You can also invoke a command by calling the
<SPAN CLASS="attrib">doCommand</SPAN> method either of the
<A CLASS="tag" HREF="elemref/ref_command.html">command</A> element or an element attached to the command
such as a button.
</P>


<H3>Command Dispatching</H3>

<P>
You can also use commands without using <A CLASS="tag" HREF="elemref/ref_command.html">command</A>
elements, or at least, without adding a <SPAN CLASS="attrib">oncommand</SPAN>
attribute to the command. In this case, the command will not invoke a script
directly, but instead, find an element or function which will handle the
command. This function may be separate from the XUL itself, and might be
handled internally by a widget. In order to find something to handle the
command, XUL uses an object called a command dispatcher. This object locates
a handler for a command. A handler for a command is called a controller. So,
essentially, when a command is invoked, the command dispatcher locates a
controller which can handle the command. You can think of the
<A CLASS="tag" HREF="elemref/ref_command.html">command</A> element as a type of controller for the
command.
</P>

<P>
The command dispatcher locates a controller by looking at the currently
focused element to see if it has a controller which can handle the command.
XUL elements have a <SPAN CLASS="attrib">controllers</SPAN> property which
is used to check. You can use the <SPAN CLASS="attrib">controllers</SPAN>
property to add your own controllers. You might use this to have a listbox
respond to cut, copy and paste operations, for instance. An example of this
will be provided later. By default, only textboxes have a controller that does
anything. The textbox controller handles clipboard operations, selection, undo
and redo as well as some editing operations. Note that an element may have
multiple controllers, which will all be checked.
</P>

<P>
If the currently focused element does not have a suitable controller, the
window is checked next. The window also has a
<SPAN CLASS="attrib">controllers</SPAN> property which you can modify if
desired. If the focus is inside a frame, each frame leading to the top-level
window is checked as as well. This means that commands will work even if the
focus is inside a frame. This works well for a browser, since editing commands
invoked from the main menu will work inside the content area. Note that HTML
also has a commands and controller system although you can't use it on
unprivileged web pages, but you may use it from, for example, a browser
extension. If the window doesn't provide a controller capable of handling the
command, nothing will happen.
</P>

<P>
You can get the command dispatcher using the document's
<SPAN CLASS="attrib">commandDispatcher</SPAN> property, or you can retrieve
it from the controllers list on an element or a window. The command dispatcher
contains methods for retrieving controllers for commands and for retrieving and
modifying the focus.
</P>

<P>
You can implement your own controllers to respond to commands. You could even
override the default handling of a command with careful placement of the
controller. A controller is expected to implement four methods, which are
listed below:
</P>

<UL>
  <LI><STRONG>supportsCommand (command)</STRONG>: this method should return
      true if the controller supports a command. If you return false, the
      command is not handled and command dispatcher will look for another
      controller. A single controller may support multiple commands.</LI>
  <LI><STRONG>isCommandEnabled (command)</STRONG>: this method should return
      true if the command is enabled, or false if it is disabled. Corresponding
      buttons will be disabled automatically.
  <LI><STRONG>doCommand (command)</STRONG>: execute the command. This is where
      you would put the code to handle the command.</LI>
  <LI><STRONG>onEvent (event)</STRONG>: this method handles an event.</LI>
</UL>

<P>
Let's assume that we want to implement a listbox that handles the delete
command. When the user selects Delete from the menu, the listbox deletes the
selected row. In this case, you just need to attach a controller to a listbox
which will perform the action.<SPAN CLASS="attrib">doCommand</SPAN> method
</P>

<P>
Try <A HREF="examples/commands.xul">opening the example below</A> in a browser
window and selecting items from the list. You'll notice that the Delete
command on the browser's Edit menu is enabled and that selecting it will
delete a row. The example below isn't completely polished. Really, we should
ensure that the selection and focus is adjusted appropriately after a deletion.
</P>


<DIV CLASS="sample"><PRE>&lt;window id="controller-example" title="Controller Example" onload="init();"
        xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"&gt;

&lt;script&gt;
function init()
{
  var list = document.getElementById("theList");

  var listController = {
    supportsCommand : function(cmd){ return (cmd == "cmd_delete"); },
    isCommandEnabled : function(cmd){
      if (cmd == "cmd_delete") return (list.selectedItem != null);
      return false;
    },
    doCommand : function(cmd){
      list.removeItemAt(list.selectedIndex);
    },
    onEvent : function(evt){ }
  };

  list.controllers.appendController(listController);
}
&lt;/script&gt;

&lt;listbox id="theList"&gt;
  &lt;listitem label="Ocean"/&gt;
  &lt;listitem label="Desert"/&gt;
  &lt;listitem label="Jungle"/&gt;
  &lt;listitem label="Swamp"/&gt;
&lt;/listbox&gt;

&lt;/window&gt;</PRE></DIV>



<P>
The controller (listController) implements the four methods described above.
The <SPAN CLASS="attrib">supportsCommand</SPAN> method returns true for the
'cmd_delete' command, which is the name of the command used when the Delete
menu item is selected. For other commands, false should be returned since the
controller does not handle any other commands. If you wanted to handle more
commands, check for them here, since you will often use a single controller
for multiple related commands.
</P>

<P>
The <SPAN CLASS="attrib">isCommandEnabled</SPAN> method returns true if the
command should be enabled. In this case, we check if there is a selected item
in the listbox and return true if there is. If there is no selection, false is
returned. If you delete all the rows in the example, the Delete command will
become disabled. You may have to click the listbox to update the menu in this
simple example. The <SPAN CLASS="attrib">doCommand</SPAN> method will be
called when the Delete menu item is selected, and this will cause the selected
row in the listbox to be deleted. Nothing needs to happen for the
<SPAN CLASS="attrib">onEvent</SPAN> method, so no code is added for this
method.
</P>

<P>
We attach this controller to the listbox by calling the
<SPAN CLASS="attrib">appendController</SPAN> method of the listbox's
controllers. The
<a href="http://www.xulplanet.com/references/xpcomref/ifaces/nsIControllers.html">controller object</a>
has a number of methods that may be used to manipulate the controllers.
For instance, there is also an <SPAN CLASS="attrib">insertControllerAt</SPAN>
method which inserts a controller into an element before other ones. This
might be useful to override commands. For example, the following example will
disable pasting into a textbox.
</P>


<DIV CLASS="sample"><PRE>var tboxController = {
  supportsCommand : function(cmd){ return (cmd == "cmd_paste"); },
  isCommandEnabled : function(cmd){ return false; },
  doCommand : function(cmd){ },
  onEvent : function(evt){ }
};

document.getElementById("tbox").controllers.insertControllerAt(0,tboxController);</PRE></DIV>



<P>
In this example, we insert the controller at index 0, which means before any
others. The new controller supports the 'cmd_paste' command and always
indicates that the command is disabled. The default textbox controller never
gets called because the command dispatcher found the controller above to
handle the command first.
</P>

<HR>
<P>
<A HREF="commandupdate.html">(Next)</A>
Next, we'll find out how to update commands.

</P>
<P>

Examples:
  <A HREF='examples/ex_commands_1.xul.txt'>6.5.1</A>
  <A HREF='examples/ex_commands_2.xul.txt'>6.5.2</A>
</P>
</div>

<div class="navlinks-pnc">

  <a class="prevlink" title="6.4 - Focus and Selection"
     href="focus.html">Previous</a>


  <a class="nextlink" title="6.6 - Updating Commands"
     href="commandupdate.html">Next</a>

</div>

</div>

<hr class="edgesplit">

<div id="copyblock">
  Copyright (C) 1999 - 2004 XulPlanet.com
</div>

</body>
</html>

