<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">

<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">

<link rel="stylesheet" title="Default Style" href="styles/default/main.css" type="text/css">
<link rel="stylesheet" href="styles/default/xultu.css" type="text/css">


<link rel="stylesheet" href="styles/default/xultu-print.css" type="text/css" media="print">


<link rel="home"   href="http://www.xulplanet.com/"            title="http://www.XulPlanet.com/">
<link rel="search" href="http://www.xulplanet.com/cgi-bin/search/search.cgi" title="Search XulPlanet">
<link rel="author" href="http://www.xulplanet.com/ndeakin" title="Neil Deakin">
 <link rel="up" href="http://www.xulplanet.com/tutorials/" title="Up"> 
 <link rel="first" href="intro.html" title="First"> 
 <link rel="last" href="end.html" title="Last"> 

 <link rel="prev" href="xblprops.html"> 
 <link rel="next" href="xblevents.html"> 

<meta name="Description" content="Step by step tutorial of the XML User Interface Language">

<title>XulPlanet.com - Adding Methods</title>

</head>
<body>

<div id="header">
  <a href="http://www.xulplanet.com/">
    <img id="logo" src="images/xulplanet.png" width="215" height="65" alt="XUL Planet">
  </a>

<div id="locationlinks">
  <a href="http://www.xulplanet.com/">Home</a> &gt;

  <a href="http://www.xulplanet.com/tutorials/">Tutorials</a> :


  <a href="index.html">XUL Tutorial</a> :



 11.5 - Adding Methods 
</div>



</div>



<hr class="edgesplit">

<div id="sidebar">

<div id="search">
  <form action="/cgi-bin/search/search.cgi" method="get">
    Search:<br>
    <input id="search-box" name="Terms" type="text">
    <input type="submit" value="Go">
  </form>
</div>

<hr>

<ul class="sidebar-section-links">
  <li><a href="http://www.xulplanet.com/tutorials/xultu/allofit.zip">Single Document Version</a></li>
  <li><a href="http://www.xulplanet.com/tutorials/xultu/xultu.zip">Download the XUL Tutorial</a><br></li>
  <li><a href="http://www.xulplanet.com/references/elemref/">Element Reference</a></li>
  <li><a href="http://www.xulplanet.com/references/elemref/quickref.html">Quick Reference</a><br></li>
  <li><a href="keyref.html">Key Code Reference</a></li>
  <li><a href="templateex.html">Template Syntax Examples</a></li>
</ul>

<hr>



<OL id="sidebar-docs-index">
  <LI class="sidebar-section-title">Introduction
  <OL>
    <LI> <A HREF="intro.html">Introduction</A></LI>
    <LI> <A HREF="xulfile.html">XUL Structure</A></LI>
    <LI> <A HREF="chromeurl.html">The Chrome URL</A></LI>
    <LI> <A HREF="packaging.html">Contents.rdf Files</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">Simple Elements
  <OL>
    <LI> <A HREF="window.html">Creating a Window</A></LI>
    <LI> <A HREF="buttons.html">Adding Buttons</A></LI>
    <LI> <A HREF="textimage.html">Adding Labels and Images</A></LI>
    <LI> <A HREF="inputs.html">Input Controls</A></LI>
    <LI> <A HREF="lists.html">List Controls</A></LI>
    <LI> <A HREF="progress.html">Progress Meters</A></LI>
    <LI> <A HREF="htmlelem.html">Adding HTML Elements</A></LI>
    <LI> <A HREF="springs.html">Using Spacers</A></LI>
    <LI> <A HREF="advbtns.html">More Button Features</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">The Box Model
  <OL>
    <LI> <A HREF="boxes.html">The Box Model</A></LI>
    <LI> <A HREF="boxstyle.html">Element Positioning</A></LI>
    <LI> <A HREF="boxdet.html">Box Model Details</A></LI>
    <LI> <A HREF="titledbox.html">Groupboxes</A></LI>
    <LI> <A HREF="boxfinal.html">Adding More Elements</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">More Layout Elements
  <OL>
    <LI> <A HREF="stacks.html">Stacks and Decks</A></LI>
    <LI> <A HREF="bulletins.html">Stack Positioning</A></LI>
    <LI> <A HREF="tabpanel.html">Tabboxes</A></LI>
    <LI> <A HREF="grids.html">Grids</A></LI>
    <LI> <A HREF="cpanels.html">Content Panels</A></LI>
    <LI> <A HREF="splitter.html">Splitters</A></LI>
    <LI> <A HREF="scroll.html">Scroll Bars</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">Toolbars and Menus
  <OL>
    <LI> <A HREF="toolbar.html">Toolbars</A></LI>
    <LI> <A HREF="menubar.html">Simple Menu Bars</A></LI>
    <LI> <A HREF="advmenu.html">More Menu Features</A></LI>
    <LI> <A HREF="popups.html">Popup Menus</A></LI>
    <LI> <A HREF="menuscroll.html">Scrolling Menus</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">Events and Scripts
  <OL>
    <LI> <A HREF="events.html">Adding Event Handlers</A></LI>
    <LI> <A HREF="advevents.html">More Event Handlers</A></LI>
    <LI> <A HREF="keyshort.html">Keyboard Shortcuts</A></LI>
    <LI> <A HREF="focus.html">Focus and Selection</A></LI>
    <LI> <A HREF="commands.html">Commands</A></LI>
    <LI> <A HREF="commandupdate.html">Updating Commands</A></LI>
    <LI> <A HREF="broadob.html">Broadcasters and Observers</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">Document Object Model
  <OL>
    <LI> <A HREF="dom.html">Document Object Model</A></LI>
    <LI> <A HREF="dommodify.html">Modifying a XUL Interface</A></LI>
    <LI> <A HREF="domlists.html">Manipulating Lists</A></LI>
    <LI> <A HREF="boxobject.html">Box Objects</A></LI>
    <LI> <A HREF="xpcom.html">XPCOM Interfaces</A></LI>
    <LI> <A HREF="xpcomex.html">XPCOM Examples</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">Trees
  <OL>
    <LI> <A HREF="trees.html">Trees</A></LI>
    <LI> <A HREF="advtrees.html">More Tree Features</A></LI>
    <LI> <A HREF="seltree.html">Tree Selection</A></LI>
    <LI> <A HREF="treeview.html">Custom Tree Views</A></LI>
    <LI> <A HREF="treeviewdet.html">Tree View Details</A></LI>
    <LI> <A HREF="treeboxobject.html">Tree Box Objects</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">RDF and Templates
  <OL>
    <LI> <A HREF="intrordf.html">Introduction to RDF</A></LI>
    <LI> <A HREF="templates.html">Templates</A></LI>
    <LI> <A HREF="treetempl.html">Trees and Templates</A></LI>
    <LI> <A HREF="datasrc.html">RDF Datasources</A></LI>
    <LI> <A HREF="advrules.html">Advanced Rules</A></LI>
    <LI> <A HREF="persist.html">Persistent Data</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">Skins and Locales
  <OL>
    <LI> <A HREF="style.html">Adding Style Sheets</A></LI>
    <LI> <A HREF="treestyle.html">Styling a Tree</A></LI>
    <LI> <A HREF="defskin.html">Modifying the Default Skin</A></LI>
    <LI> <A HREF="cskin.html">Creating a Skin</A></LI>
    <LI> <A HREF="locale.html">Localization</A></LI>
    <LI> <A HREF="locprops.html">Property Files</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">Bindings
  <OL>
    <LI> <A HREF="introxbl.html">Introduction to XBL</A></LI>
    <LI> <A HREF="xblcontent.html">Anonymous Content</A></LI>
    <LI> <A HREF="xblatin.html">XBL Attribute Inheritance</A></LI>
    <LI> <A HREF="xblprops.html">Adding Properties</A></LI>
    <LI> <SPAN CLASS="currentpage">Adding Methods</SPAN></LI>
    <LI> <A HREF="xblevents.html">Adding Event Handlers</A></LI>
    <LI> <A HREF="xblinherit.html">XBL Inheritance</A></LI>
    <LI> <A HREF="xblex.html">XBL Example</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">Specialized Window Types
  <OL>
    <LI> <A HREF="featwin.html">Features of a Window</A></LI>
    <LI> <A HREF="dialogs.html">Creating Dialogs</A></LI>
    <LI> <A HREF="filedialog.html">Open and Save Dialogs</A></LI>
    <LI> <A HREF="wizard.html">Creating a Wizard</A></LI>
    <LI> <A HREF="advwiz.html">More Wizards</A></LI>
    <LI> <A HREF="overlay.html">Overlays</A></LI>
    <LI> <A HREF="crosspov.html">Cross Package Overlays</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">Installation
  <OL>
    <LI> <A HREF="xpinstall.html">Creating an Installer</A></LI>
    <LI> <A HREF="xpiscript.html">Install Scripts</A></LI>
    <LI> <A HREF="xpiadv.html">Additional Install Features</A></LI>
  </OL>
</OL>

</div>



<div id="content">

<div class="navlinks-pnc">

  <a class="prevlink" title="11.4 - Adding Properties"
     href="xblprops.html">Previous</a>


  <a class="nextlink" title="11.6 - Adding Event Handlers"
     href="xblevents.html">Next</a>

</div>

<div class="xultu-content">

<h2>Adding Methods</h2>

<P>
Next, we'll find out how to add custom methods to XBL-defined elements.
</P>

<H3>Methods</H3>

<P>
In addition to adding script properties to the XBL-defined element, you can also
add methods. These methods can be called from a script. Methods are the functions
of objects, such as 'window.open()'. You can define custom methods for your
elements using the <A CLASS="tag" HREF="elemref/ref_xblmethod.html">method</A> element. The general syntax of
methods is as follows:
</P>


<DIV CLASS="sample"><PRE>&lt;implementation&gt;
  &lt;method name="method-name"&gt;
    &lt;parameter name="parameter-name1"/&gt;
    &lt;parameter name="parameter-name2"/&gt;
    .
    .
    .
    &lt;body&gt;
      -- method script goes here --
    &lt;/body&gt;
  &lt;/method&gt;
&lt;/implementation&gt;</PRE></DIV>



<P>
A method declaration goes inside the <A CLASS="tag" HREF="elemref/ref_xblimplementation.html">implementation</A>
element, like the fields and properties do. The <A CLASS="tag" HREF="elemref/ref_xblmethod.html">method</A>
element contains two type of child elements, <A CLASS="tag" HREF="elemref/ref_xblparameter.html">parameter</A>
elements which describe the parameters to the method and
<A CLASS="tag" HREF="elemref/ref_xblbody.html">body</A> which contains the script for the method.
</P>

<P>
The value of the <SPAN CLASS="attrib">name</SPAN> attribute becomes the name of
the method. Similarly, the <SPAN CLASS="attrib">name</SPAN> attributes on the
<A CLASS="tag" HREF="elemref/ref_xblparameter.html">parameter</A> elements become the names of each parameter.
Each <A CLASS="tag" HREF="elemref/ref_xblparameter.html">parameter</A> element is used to declare one parameter
for the method. For example, if the method had three parameters, there would be
three <A CLASS="tag" HREF="elemref/ref_xblparameter.html">parameter</A> elements. You do not need to have any
though, in which case the method would take no parameters.
</P>

<P>
The <A CLASS="tag" HREF="elemref/ref_xblbody.html">body</A> element contains the script that is executed
when the method is called. The names of the parameters are defined as variables
in the script as if they had been passed as parameters. For example, the
following JavaScript function would be written as an XBL method like so:
</P>


<DIV CLASS="sample"><PRE>function getMaximum(num1,num2)
{
  if (num1&lt;=num2) return num2;
  else return num1;
}

<B>XBL:</B>

&lt;method name="getMaximum"&gt;
  &lt;parameter name="num1"/&gt;
  &lt;parameter name="num2"/&gt;
  &lt;body&gt;
    if (num1&amp;lt;=num2) return num2;
    else return num1;
  &lt;/body&gt;
&lt;method&gt;</PRE></DIV>



<P>
This function, getMaximum, returns the largest of the values, each passed
as an parameter to the method. Note that the less-than symbol has to be
escaped because otherwise it would look like the start of a tag. You can
also use a CDATA section to escape the entire block of code. You can
call the method by using code such as 'element.getMaximum(5,10)' where
element is a reference to an element defined by the XBL containing the
getMaximum method. (The bound element.)
</P>

<P>
The <A CLASS="tag" HREF="elemref/ref_xblparameter.html">parameter</A> tag allows you to define parameters
for a method. Because Mozilla uses JavaScript as its scripting language, and
JavaScript is a non-typed language, you do not need to specify the types
of the parameters. However, in the future, other languages may be used
with XBL.
</P>

<H3>Accessing the Anonymous Content</H3>

<P>
There may be times when you want to modify some aspect of the elements
defined in the <A CLASS="tag" HREF="elemref/ref_xblcontent.html">content</A> element, either from a method
body or elsewhere. These elements are created anonymously and are not
accessible from the regular DOM functions. They are hidden so that developers
do not need to know how the element is implemented to use it. However, there
is a special way of getting this anonymous content.
</P>

<P>
Elements with an XBL behavior attached to them have a special property which
holds an array of the anonymous child elements inside it. Each element of the
array stores each direct child element of the XBL-defined element. This
special property cannot be accessed directly. Instead, you must call the
document's getAnonymousNodes method:
</P>


<DIV CLASS="sample"><PRE>var value=document.getAnonymousNodes(element);</PRE></DIV>



<P>
Here, 'element' should be set a to reference to the element that you want to
get the anonymous content of. The function returns an array of elements, which
is the anonymous content. To get elements below that, you can use the regular
DOM functions because they aren't hidden. Note that it is possible for an
XBL-bound element to be placed inside another one, in which case you will have
to use the getAnonymousNodes function again.
</P>

<P>
The following example creates a row of buttons:
</P>


<DIV CLASS="sample"><PRE>&lt;binding id="buttonrow"&gt;
  &lt;content&gt;
    &lt;button label="Yes"/&gt;
    &lt;button label="No"/&gt;
    &lt;button label="Sort Of"/&gt;
  &lt;/content&gt;
&lt;/binding&gt;</PRE></DIV>



<P>
To refer to each button, you can use the getAnonymousNodes function, passing it
a reference to the element the binding is bound to as the parameter. In the
returned array, the first button is stored in the first array element
('getAnonymousNodes(element)[0]'), the second button is stored in the second
array element and the third button is stored in the third array element.
For code inside a binding method, you can pass 'this' as the parameter to
getAnonymousNodes.
</P>

<P>
The next example can be used to create text with a label. The method 'showTitle'
can be used to show or hide the label. It works by getting a reference to the
title element using the anonymous array and changing the visibility of it.
</P>


<DIV CLASS="sample"><PRE><B>XUL:</B>

&lt;box id="num" class="labeledbutton" title="Number of Things:" value="52"/&gt;

&lt;button label="Show" oncommand="document.getElementById('num').showTitle(true)"/&gt;
&lt;button label="Hide" oncommand="document.getElementById('num').showTitle(false)"/&gt;

<B>XBL:</B>

&lt;binding id="labeledbutton"&gt;
  &lt;content&gt;
    &lt;xul:label xbl:inherits="value=title"/&gt;
    &lt;xul:label xbl:inherits="value"/&gt;
  &lt;/content&gt;
  &lt;implementation&gt;
    &lt;method name="showTitle"&gt;
      &lt;parameter name="state"/&gt;
      &lt;body&gt;
        if (state) document.getAnonymousNodes(this)[0].
          setAttribute("style","visibility: visible");
        else document.getAnonymousNodes(this)[0].
          setAttribute("style","visibility: collapse");
      &lt;/body&gt;
    &lt;/method&gt;
  &lt;/implementation&gt;
&lt;/binding&gt;</PRE></DIV>



<P>
Two buttons added to the XUL have <SPAN CLASS="attrib">oncommand</SPAN> handlers
which are used to change the visibility of the label. Each calls the 'showTitle'
method. This method checks to see whether the element is being hidden or shown
from the 'state' parameter that is passed in. In either case, it grabs the first
element of the anonymous array. This refers to the first child in the
<A CLASS="tag" HREF="elemref/ref_xblcontent.html">content</A> element, which here is the first label widget.
The visibility is changed by modifying the style on the element.
</P>

<P>
To go the other way, and get the bound element from inside the anonymous content,
use the DOM 'parentNode' property. This gets the parent element of an element.
For example, we could move the Show and Hide buttons into the XBL file and do
the following:
</P>


Example 11.5.1:
<A HREF='examples/ex_xblmethods_1.xml.txt'>Source</A>
<DIV CLASS="example"><PRE>&lt;binding id="labeledbutton"&gt;
  &lt;content&gt;
    &lt;xul:label xbl:inherits="value=title"/&gt;
    &lt;xul:label xbl:inherits="value"/&gt;
    &lt;xul:button label="Show" oncommand="parentNode.showTitle(true);"/&gt;
    &lt;xul:button label="Hide" oncommand="parentNode.showTitle(false);"/&gt;
  &lt;/content&gt;
  &lt;implementation&gt;
    &lt;method name="showTitle"&gt;
      &lt;parameter name="state"/&gt;
      &lt;body&gt;
        if (state) document.getAnonymousNodes(this)[0].setAttribute("style","visibility: visible");
        else document.getAnonymousNodes(this)[0].setAttribute("style","visibility: collapse");
      &lt;/body&gt;
    &lt;/method&gt;
  &lt;/implementation&gt;
&lt;/binding&gt;</PRE></DIV>



<P>
The <SPAN CLASS="attrib">oncommand</SPAN> handlers here first get a reference to their
parent element. This is not the <A CLASS="tag" HREF="elemref/ref_xblcontent.html">content</A> element but the
XUL element that the XBL is bound to. (In this example, it is the box with
the <SPAN CLASS="aval">labeledbutton</SPAN> class). Then, the 'showTitle' method is
called, which functions as it did before.
</P>

<P>
Custom properties and methods are added only to the outer XUL element the XBL is
bound to. None of the elements declared inside the <A CLASS="tag" HREF="elemref/ref_xblcontent.html">content</A>
tag have these properties or methods. This is why we have to get the parent first.
</P>

<P>
The children of an element placed in the XUL file can be retrieved in the normal
way and don't move even if you use the <A CLASS="tag" HREF="elemref/ref_xblchildren.html">children</A> tag. For
example:
</P>


<DIV CLASS="sample"><PRE><B>XUL:</B>

&lt;box id="outer" class="container"&gt;
  &lt;button label="One"/&gt;
  &lt;button label="Two"/&gt;
  &lt;button label="Three"/&gt;
  &lt;button label="Four"/&gt;
&lt;/box&gt;

<B>XBL:</B>

&lt;binding id="labeledbutton"&gt;
  &lt;content&gt;
    &lt;description value="A stack:"/&gt;
    &lt;stack&gt;
      &lt;children/&gt;
    &lt;/stack&gt;
  &lt;/content&gt;
&lt;/binding&gt;</PRE></DIV>



<P>
If you use the DOM functions such as 'childNodes' to get the children of an
element, you'll find that the XUL box, the one with the
<SPAN CLASS="attrib">id</SPAN> of
<SPAN CLASS="aval">outer</SPAN>, has 4 children. These correspond to its
four buttons, even through those buttons are drawn inside the stack. The
stack has only one child, the <A CLASS="tag" HREF="elemref/ref_xblchildren.html">children</A> element
itself. The length of the anonymous array of the outer box is two,
the first element the <A CLASS="tag" HREF="elemref/ref_description.html">description</A> element and the
second the <A CLASS="tag" HREF="elemref/ref_stack.html">stack</A> element.
</P>

<H3>Constructors and Destructors</H3>

<P>
XBL supports two special methods created with separate tags,
<A CLASS="tag" HREF="elemref/ref_xblconstructor.html">constructor</A> and
<A CLASS="tag" HREF="elemref/ref_xbldestructor.html">destructor</A>. A constructor is called whenever the
binding is attached to an element. It is used to initialize the content
such as loading preferences or setting the default values of fields.
The destructor is called when a binding is removed from an element. This
might be used to save information.
</P>

<P>
There are two points when a binding is attached to an element. The first occurs
when a window is displayed. All elements that have XBL-bound content will have
their constructors invoked. The order that they are called in should
not be relied upon, as they are loaded from various files. The window's onload
handler is not called until after all the bindings have been attached and their
constructors finished. The second point a binding is attached is if you change the
<SPAN CLASS="attrib">-moz-binding</SPAN> style property of an element. The existing
binding will be removed, after its destructor is called. Then, the new 
binding will be added in its place and its constructor invoked.
</P>

<P>
The script for a constructor or destructor should be placed directly inside
the appropriate tag. There should only be at most one of each per binding and
they take no arguments. Here are some examples:
</P>


<DIV CLASS="sample"><PRE>&lt;constructor&gt;
  if (this.childNodes[0].getAttribute("open") == "true"){
    this.loadChildren();
  }
&lt;/constructor&gt;

&lt;destructor action="saveMyself(this);"/&gt;</PRE></DIV>



<HR>
<P>
<A HREF="xblevents.html">(Next)</A>
The next section shows how to add event handlers to XBL-defined elements.

</P>
<P>

Examples:
  <A HREF='examples/ex_xblmethods_1.xml.txt'>11.5.1</A>
</P>
</div>

<div class="navlinks-pnc">

  <a class="prevlink" title="11.4 - Adding Properties"
     href="xblprops.html">Previous</a>


  <a class="nextlink" title="11.6 - Adding Event Handlers"
     href="xblevents.html">Next</a>

</div>

</div>

<hr class="edgesplit">

<div id="copyblock">
  Copyright (C) 1999 - 2004 XulPlanet.com
</div>

</body>
</html>

