VERSION 1.0 CLASS
BEGIN
  MultiUse = -1  'True
  Persistable = 0  'NotPersistable
  DataBindingBehavior = 0  'vbNone
  DataSourceBehavior  = 0  'vbNone
  MTSTransactionMode  = 0  'NotAnMTSObject
END
Attribute VB_Name = "MSProjHTML"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = True
Option Explicit
Private gProjFile As String
Private gMSProj As MSProject.Project
Private gMPPName As String
Private gWebFilesPath As String
Private gOutHTMLStr As String

Private gFieldArr(219) As MSProject.PjField
Private gFieldNamesArr(219) As Variant
Private gResArr(185) As MSProject.PjField
Private gResNamesArr(185) As Variant

Public Sub Init()
gFieldArr(0) = pjTaskPercentComplete
gFieldArr(1) = pjTaskPercentWorkComplete
gFieldArr(2) = pjTaskActualCost
gFieldArr(3) = pjTaskActualDuration
gFieldArr(4) = pjTaskActualFinish
gFieldArr(5) = pjTaskActualOvertimeCost
gFieldArr(6) = pjTaskActualOvertimeWork
gFieldArr(7) = pjTaskActualStart
gFieldArr(8) = pjTaskActualWork
gFieldArr(9) = pjTaskACWP
gFieldArr(10) = pjTaskAssignmentDelay
gFieldArr(11) = pjTaskAssignmentUnits
gFieldArr(12) = pjTaskBaselineCost
gFieldArr(13) = pjTaskBaselineDuration
gFieldArr(14) = pjTaskBaselineFinish
gFieldArr(15) = pjTaskBaselineStart
gFieldArr(16) = pjTaskBaselineWork
gFieldArr(17) = pjTaskBCWP
gFieldArr(18) = pjTaskBCWS
gFieldArr(19) = pjTaskConfirmed
gFieldArr(20) = pjTaskConstraintDate
gFieldArr(21) = pjTaskConstraintType
gFieldArr(22) = pjTaskContact
gFieldArr(23) = pjTaskCost
gFieldArr(24) = pjTaskCost1
gFieldArr(25) = pjTaskCost2
gFieldArr(26) = pjTaskCost3
gFieldArr(27) = pjTaskCost4
gFieldArr(28) = pjTaskCost5
gFieldArr(29) = pjTaskCost6
gFieldArr(30) = pjTaskCost7
gFieldArr(31) = pjTaskCost8
gFieldArr(32) = pjTaskCost9
gFieldArr(33) = pjTaskCost10
gFieldArr(34) = pjTaskCostRateTable
gFieldArr(35) = pjTaskCostVariance
gFieldArr(36) = pjTaskCreated
gFieldArr(37) = pjTaskCritical
gFieldArr(38) = pjTaskCV
gFieldArr(39) = pjTaskDate1
gFieldArr(40) = pjTaskDate2
gFieldArr(41) = pjTaskDate3
gFieldArr(42) = pjTaskDate4
gFieldArr(43) = pjTaskDate5
gFieldArr(44) = pjTaskDate6
gFieldArr(45) = pjTaskDate7
gFieldArr(46) = pjTaskDate8
gFieldArr(47) = pjTaskDate9
gFieldArr(48) = pjTaskDate10
gFieldArr(49) = pjTaskDuration
gFieldArr(50) = pjTaskDuration1
gFieldArr(51) = pjTaskDuration2
gFieldArr(52) = pjTaskDuration3
gFieldArr(53) = pjTaskDuration4
gFieldArr(54) = pjTaskDuration5
gFieldArr(55) = pjTaskDuration6
gFieldArr(56) = pjTaskDuration7
gFieldArr(57) = pjTaskDuration8
gFieldArr(58) = pjTaskDuration9
gFieldArr(59) = pjTaskDuration10
gFieldArr(60) = pjTaskDurationVariance
gFieldArr(61) = pjTaskEarlyFinish
gFieldArr(62) = pjTaskEarlyStart
gFieldArr(63) = pjTaskEffortDriven
gFieldArr(64) = pjTaskExternalTask
gFieldArr(65) = pjTaskFinish
gFieldArr(66) = pjTaskFinish1
gFieldArr(67) = pjTaskFinish2
gFieldArr(68) = pjTaskFinish3
gFieldArr(69) = pjTaskFinish4
gFieldArr(70) = pjTaskFinish5
gFieldArr(71) = pjTaskFinish6
gFieldArr(72) = pjTaskFinish7
gFieldArr(73) = pjTaskFinish8
gFieldArr(74) = pjTaskFinish9
gFieldArr(75) = pjTaskFinish10
gFieldArr(76) = pjTaskFinishVariance
gFieldArr(77) = pjTaskFixedCost
gFieldArr(78) = pjTaskFixedCostAccrual
gFieldArr(79) = pjTaskFlag1
gFieldArr(80) = pjTaskFlag2
gFieldArr(81) = pjTaskFlag3
gFieldArr(82) = pjTaskFlag4
gFieldArr(83) = pjTaskFlag5
gFieldArr(84) = pjTaskFlag6
gFieldArr(85) = pjTaskFlag7
gFieldArr(86) = pjTaskFlag8
gFieldArr(87) = pjTaskFlag9
gFieldArr(88) = pjTaskFlag10
gFieldArr(89) = pjTaskFlag11
gFieldArr(90) = pjTaskFlag12
gFieldArr(91) = pjTaskFlag13
gFieldArr(92) = pjTaskFlag14
gFieldArr(93) = pjTaskFlag15
gFieldArr(94) = pjTaskFlag16
gFieldArr(95) = pjTaskFlag17
gFieldArr(96) = pjTaskFlag18
gFieldArr(97) = pjTaskFlag19
gFieldArr(98) = pjTaskFlag20
gFieldArr(99) = pjTaskFreeSlack
gFieldArr(100) = pjTaskHideBar
gFieldArr(101) = pjTaskHyperlink
gFieldArr(102) = pjTaskHyperlinkAddress
gFieldArr(103) = pjTaskHyperlinkHref
gFieldArr(104) = pjTaskHyperlinkSubAddress
gFieldArr(105) = pjTaskID
gFieldArr(106) = pjTaskIndicators
gFieldArr(107) = pjTaskLateFinish
gFieldArr(108) = pjTaskLateStart
gFieldArr(109) = pjTaskLevelAssignments
gFieldArr(110) = pjTaskLevelCanSplit
gFieldArr(111) = pjTaskLevelDelay
gFieldArr(112) = pjTaskLinkedFields
gFieldArr(113) = pjTaskMarked
gFieldArr(114) = pjTaskMilestone
gFieldArr(115) = pjTaskName
gFieldArr(116) = pjTaskNotes
gFieldArr(117) = pjTaskNumber1
gFieldArr(118) = pjTaskNumber2
gFieldArr(119) = pjTaskNumber3
gFieldArr(120) = pjTaskNumber4
gFieldArr(121) = pjTaskNumber5
gFieldArr(122) = pjTaskNumber6
gFieldArr(123) = pjTaskNumber7
gFieldArr(124) = pjTaskNumber8
gFieldArr(125) = pjTaskNumber9
gFieldArr(126) = pjTaskNumber10
gFieldArr(127) = pjTaskNumber11
gFieldArr(128) = pjTaskNumber12
gFieldArr(129) = pjTaskNumber13
gFieldArr(130) = pjTaskNumber14
gFieldArr(131) = pjTaskNumber15
gFieldArr(132) = pjTaskNumber16
gFieldArr(133) = pjTaskNumber17
gFieldArr(134) = pjTaskNumber18
gFieldArr(135) = pjTaskNumber19
gFieldArr(136) = pjTaskNumber20
gFieldArr(137) = pjTaskObjects
gFieldArr(138) = pjTaskOutlineLevel
gFieldArr(139) = pjTaskOutlineNumber
gFieldArr(140) = pjTaskOverallocated
gFieldArr(141) = pjTaskOvertimeCost
gFieldArr(142) = pjTaskOvertimeWork
gFieldArr(143) = pjTaskPredecessors
gFieldArr(144) = pjTaskPreleveledFinish
gFieldArr(145) = pjTaskPreleveledStart
gFieldArr(146) = pjTaskPriority
gFieldArr(147) = pjTaskProject
gFieldArr(148) = pjTaskRecurring
gFieldArr(149) = pjTaskRegularWork
gFieldArr(150) = pjTaskRemainingCost
gFieldArr(151) = pjTaskRemainingDuration
gFieldArr(152) = pjTaskRemainingOvertimeCost
gFieldArr(153) = pjTaskRemainingOvertimeWork
gFieldArr(154) = pjTaskRemainingWork
gFieldArr(155) = pjTaskResourceGroup
gFieldArr(156) = pjTaskResourceInitials
gFieldArr(157) = pjTaskResourceNames
gFieldArr(158) = pjTaskResourcePhonetics
gFieldArr(159) = pjTaskResponsePending
gFieldArr(160) = pjTaskResume
gFieldArr(161) = pjTaskRollup
gFieldArr(162) = pjTaskStart
gFieldArr(163) = pjTaskStart1
gFieldArr(164) = pjTaskStart2
gFieldArr(165) = pjTaskStart3
gFieldArr(166) = pjTaskStart4
gFieldArr(167) = pjTaskStart5
gFieldArr(168) = pjTaskStart6
gFieldArr(169) = pjTaskStart7
gFieldArr(170) = pjTaskStart8
gFieldArr(171) = pjTaskStart9
gFieldArr(172) = pjTaskStart10
gFieldArr(173) = pjTaskStartVariance
gFieldArr(174) = pjTaskStop
gFieldArr(175) = pjTaskSubproject
gFieldArr(176) = pjTaskSubprojectReadOnly
gFieldArr(177) = pjTaskSuccessors
gFieldArr(178) = pjTaskSummary
gFieldArr(179) = pjTaskSV
gFieldArr(180) = pjTaskTeamStatusPending
gFieldArr(181) = pjTaskText1
gFieldArr(182) = pjTaskText2
gFieldArr(183) = pjTaskText3
gFieldArr(184) = pjTaskText4
gFieldArr(185) = pjTaskText5
gFieldArr(186) = pjTaskText6
gFieldArr(187) = pjTaskText7
gFieldArr(188) = pjTaskText8
gFieldArr(189) = pjTaskText9
gFieldArr(190) = pjTaskText10
gFieldArr(191) = pjTaskText11
gFieldArr(192) = pjTaskText12
gFieldArr(193) = pjTaskText13
gFieldArr(194) = pjTaskText14
gFieldArr(195) = pjTaskText15
gFieldArr(196) = pjTaskText16
gFieldArr(197) = pjTaskText17
gFieldArr(198) = pjTaskText18
gFieldArr(199) = pjTaskText19
gFieldArr(200) = pjTaskText20
gFieldArr(201) = pjTaskText21
gFieldArr(202) = pjTaskText22
gFieldArr(203) = pjTaskText23
gFieldArr(204) = pjTaskText24
gFieldArr(205) = pjTaskText25
gFieldArr(206) = pjTaskText26
gFieldArr(207) = pjTaskText27
gFieldArr(208) = pjTaskText28
gFieldArr(209) = pjTaskText29
gFieldArr(210) = pjTaskText30
gFieldArr(211) = pjTaskTotalSlack
gFieldArr(212) = pjTaskType
gFieldArr(213) = pjTaskUniqueID
gFieldArr(214) = pjTaskUniquePredecessors
gFieldArr(215) = pjTaskUniqueSuccessors
gFieldArr(216) = pjTaskUpdateNeeded
gFieldArr(217) = pjTaskWorkContour
gFieldArr(218) = pjTaskWorkVariance

gFieldNamesArr(0) = "Percent Complete"
gFieldNamesArr(1) = "Percent Work Complete"
gFieldNamesArr(2) = "Actual Cost"
gFieldNamesArr(3) = "Actual Duration"
gFieldNamesArr(4) = "Actual Finish"
gFieldNamesArr(5) = "Actual Overtime Cost"
gFieldNamesArr(6) = "Actual Overtime Work"
gFieldNamesArr(7) = "Actual Start"
gFieldNamesArr(8) = "Actual Work"
gFieldNamesArr(9) = "ACWP"
gFieldNamesArr(10) = "Assignment Delay"
gFieldNamesArr(11) = "Assignment Units"
gFieldNamesArr(12) = "Baseline Cost"
gFieldNamesArr(13) = "Baseline Duration"
gFieldNamesArr(14) = "Baseline Finish"
gFieldNamesArr(15) = "Baseline Start"
gFieldNamesArr(16) = "Baseline Work"
gFieldNamesArr(17) = "BCWP"
gFieldNamesArr(18) = "BCWS"
gFieldNamesArr(19) = "Confirmed"
gFieldNamesArr(20) = "Constraint Date"
gFieldNamesArr(21) = "Constraint Type"
gFieldNamesArr(22) = "Contact"
gFieldNamesArr(23) = "Cost"
gFieldNamesArr(24) = "Cost1"
gFieldNamesArr(25) = "Cost2"
gFieldNamesArr(26) = "Cost3"
gFieldNamesArr(27) = "Cost4"
gFieldNamesArr(28) = "Cost5"
gFieldNamesArr(29) = "Cost6"
gFieldNamesArr(30) = "Cost7"
gFieldNamesArr(31) = "Cost8"
gFieldNamesArr(32) = "Cost9"
gFieldNamesArr(33) = "Cost10"
gFieldNamesArr(34) = "Cost Rate Table"
gFieldNamesArr(35) = "Cost Variance"
gFieldNamesArr(36) = "Created"
gFieldNamesArr(37) = "Critical"
gFieldNamesArr(38) = "CV"
gFieldNamesArr(39) = "Date1"
gFieldNamesArr(40) = "Date2"
gFieldNamesArr(41) = "Date3"
gFieldNamesArr(42) = "Date4"
gFieldNamesArr(43) = "Date5"
gFieldNamesArr(44) = "Date6"
gFieldNamesArr(45) = "Date7"
gFieldNamesArr(46) = "Date8"
gFieldNamesArr(47) = "Date9"
gFieldNamesArr(48) = "Date10"
gFieldNamesArr(49) = "Duration"
gFieldNamesArr(50) = "Duration1"
gFieldNamesArr(51) = "Duration2"
gFieldNamesArr(52) = "Duration3"
gFieldNamesArr(53) = "Duration4"
gFieldNamesArr(54) = "Duration5"
gFieldNamesArr(55) = "Duration6"
gFieldNamesArr(56) = "Duration7"
gFieldNamesArr(57) = "Duration8"
gFieldNamesArr(58) = "Duration9"
gFieldNamesArr(59) = "Duration10"
gFieldNamesArr(60) = "Duration Variance"
gFieldNamesArr(61) = "Early Finish"
gFieldNamesArr(62) = "Early Start"
gFieldNamesArr(63) = "Effort Driven"
gFieldNamesArr(64) = "External Task"
gFieldNamesArr(65) = "Finish Date"
gFieldNamesArr(66) = "Finish1"
gFieldNamesArr(67) = "Finish2"
gFieldNamesArr(68) = "Finish3"
gFieldNamesArr(69) = "Finish4"
gFieldNamesArr(70) = "Finish5"
gFieldNamesArr(71) = "Finish6"
gFieldNamesArr(72) = "Finish7"
gFieldNamesArr(73) = "Finish8"
gFieldNamesArr(74) = "Finish9"
gFieldNamesArr(75) = "Finish10"
gFieldNamesArr(76) = "Finish Variance"
gFieldNamesArr(77) = "Fixed Cost"
gFieldNamesArr(78) = "Fixed Cost Accrual"
gFieldNamesArr(79) = "Flag1"
gFieldNamesArr(80) = "Flag2"
gFieldNamesArr(81) = "Flag3"
gFieldNamesArr(82) = "Flag4"
gFieldNamesArr(83) = "Flag5"
gFieldNamesArr(84) = "Flag6"
gFieldNamesArr(85) = "Flag7"
gFieldNamesArr(86) = "Flag8"
gFieldNamesArr(87) = "Flag9"
gFieldNamesArr(88) = "Flag10"
gFieldNamesArr(89) = "Flag11"
gFieldNamesArr(90) = "Flag12"
gFieldNamesArr(91) = "Flag13"
gFieldNamesArr(92) = "Flag14"
gFieldNamesArr(93) = "Flag15"
gFieldNamesArr(94) = "Flag16"
gFieldNamesArr(95) = "Flag17"
gFieldNamesArr(96) = "Flag18"
gFieldNamesArr(97) = "Flag19"
gFieldNamesArr(98) = "Flag20"
gFieldNamesArr(99) = "Free Slack"
gFieldNamesArr(100) = "Hide Bar"
gFieldNamesArr(101) = "Hyperlink"
gFieldNamesArr(102) = "Hyperlink Address"
gFieldNamesArr(103) = "Hyperlink Href"
gFieldNamesArr(104) = "Hyperlink SubAddress"
gFieldNamesArr(105) = "ID"
gFieldNamesArr(106) = "Indicators"
gFieldNamesArr(107) = "Late Finish"
gFieldNamesArr(108) = "Late Start"
gFieldNamesArr(109) = "Level Assignments"
gFieldNamesArr(110) = "Leveling Can Split"
gFieldNamesArr(111) = "Leveling Delay"
gFieldNamesArr(112) = "Linked Fields"
gFieldNamesArr(113) = "Marked"
gFieldNamesArr(114) = "Milestone"
gFieldNamesArr(115) = "Name"
gFieldNamesArr(116) = "Notes"
gFieldNamesArr(117) = "Number1"
gFieldNamesArr(118) = "Number2"
gFieldNamesArr(119) = "Number3"
gFieldNamesArr(120) = "Number4"
gFieldNamesArr(121) = "Number5"
gFieldNamesArr(122) = "Number6"
gFieldNamesArr(123) = "Number7"
gFieldNamesArr(124) = "Number8"
gFieldNamesArr(125) = "Number9"
gFieldNamesArr(126) = "Number10"
gFieldNamesArr(127) = "Number11"
gFieldNamesArr(128) = "Number12"
gFieldNamesArr(129) = "Number13"
gFieldNamesArr(130) = "Number14"
gFieldNamesArr(131) = "Number15"
gFieldNamesArr(132) = "Number16"
gFieldNamesArr(133) = "Number17"
gFieldNamesArr(134) = "Number18"
gFieldNamesArr(135) = "Number19"
gFieldNamesArr(136) = "Number20"
gFieldNamesArr(137) = "Objects"
gFieldNamesArr(138) = "Outline Level"
gFieldNamesArr(139) = "Outline Number"
gFieldNamesArr(140) = "Overallocated"
gFieldNamesArr(141) = "Overtime Cost"
gFieldNamesArr(142) = "Overtime Work"
gFieldNamesArr(143) = "Predecessors"
gFieldNamesArr(144) = "Preleveled Finish"
gFieldNamesArr(145) = "Preleveled Start"
gFieldNamesArr(146) = "Priority"
gFieldNamesArr(147) = "Project"
gFieldNamesArr(148) = "Recurring"
gFieldNamesArr(149) = "Regular Work"
gFieldNamesArr(150) = "Remaining Cost"
gFieldNamesArr(151) = "Remaining Duration"
gFieldNamesArr(152) = "Remaining Overtime Cost"
gFieldNamesArr(153) = "Remaining Overtime Work"
gFieldNamesArr(154) = "Remaining Work"
gFieldNamesArr(155) = "Resource Group"
gFieldNamesArr(156) = "Resource Initials"
gFieldNamesArr(157) = "Resource Names"
gFieldNamesArr(158) = "Resource Phonetics"
gFieldNamesArr(159) = "Response Pending"
gFieldNamesArr(160) = "Resume"
gFieldNamesArr(161) = "Rollup"
gFieldNamesArr(162) = "Start Date"
gFieldNamesArr(163) = "Start1"
gFieldNamesArr(164) = "Start2"
gFieldNamesArr(165) = "Start3"
gFieldNamesArr(166) = "Start4"
gFieldNamesArr(167) = "Start5"
gFieldNamesArr(168) = "Start6"
gFieldNamesArr(169) = "Start7"
gFieldNamesArr(170) = "Start8"
gFieldNamesArr(171) = "Start9"
gFieldNamesArr(172) = "Start10"
gFieldNamesArr(173) = "Start Variance"
gFieldNamesArr(174) = "Stop"
gFieldNamesArr(175) = "Subproject File"
gFieldNamesArr(176) = "Subproject Read Only"
gFieldNamesArr(177) = "Successors"
gFieldNamesArr(178) = "Summary"
gFieldNamesArr(179) = "SV"
gFieldNamesArr(180) = "Team Status Pending"
gFieldNamesArr(181) = "Text1"
gFieldNamesArr(182) = "Text2"
gFieldNamesArr(183) = "Text3"
gFieldNamesArr(184) = "Text4"
gFieldNamesArr(185) = "Text5"
gFieldNamesArr(186) = "Text6"
gFieldNamesArr(187) = "Text7"
gFieldNamesArr(188) = "Text8"
gFieldNamesArr(189) = "Text9"
gFieldNamesArr(190) = "Text10"
gFieldNamesArr(191) = "Text11"
gFieldNamesArr(192) = "Text12"
gFieldNamesArr(193) = "Text13"
gFieldNamesArr(194) = "Text14"
gFieldNamesArr(195) = "Text15"
gFieldNamesArr(196) = "Text16"
gFieldNamesArr(197) = "Text17"
gFieldNamesArr(198) = "Text18"
gFieldNamesArr(199) = "Text19"
gFieldNamesArr(200) = "Text20"
gFieldNamesArr(201) = "Text21"
gFieldNamesArr(202) = "Text22"
gFieldNamesArr(203) = "Text23"
gFieldNamesArr(204) = "Text24"
gFieldNamesArr(205) = "Text25"
gFieldNamesArr(206) = "Text26"
gFieldNamesArr(207) = "Text27"
gFieldNamesArr(208) = "Text28"
gFieldNamesArr(209) = "Text29"
gFieldNamesArr(210) = "Text30"
gFieldNamesArr(211) = "Total Slack"
gFieldNamesArr(212) = "Type"
gFieldNamesArr(213) = "Unique ID"
gFieldNamesArr(214) = "Unique ID Predecessors"
gFieldNamesArr(215) = "Unique ID Successors"
gFieldNamesArr(216) = "Update Needed"
gFieldNamesArr(217) = "Work Contour"
gFieldNamesArr(218) = "Work Variance"

gResArr(0) = pjResourcePercentWorkComplete
gResArr(1) = pjResourceAccrueAt
gResArr(2) = pjResourceActualCost
gResArr(3) = pjResourceActualOvertimeCost
gResArr(4) = pjResourceActualOvertimeWork
gResArr(5) = pjResourceActualWork
gResArr(6) = pjResourceACWP
gResArr(7) = pjResourceAssignment
gResArr(8) = pjResourceAssignmentDelay
gResArr(9) = pjResourceAssignmentUnits
gResArr(10) = pjResourceAvailableFrom
gResArr(11) = pjResourceAvailableTo
gResArr(12) = pjResourceBaseCalendar
gResArr(13) = pjResourceBaselineCost
gResArr(14) = pjResourceBaselineFinish
gResArr(15) = pjResourceBaselineStart
gResArr(16) = pjResourceBaselineWork
gResArr(17) = pjResourceBCWP
gResArr(18) = pjResourceBCWS
gResArr(19) = pjResourceCanLevel
gResArr(20) = pjResourceCode
gResArr(21) = pjResourceConfirmed
gResArr(22) = pjResourceCost
gResArr(23) = pjResourceCost1
gResArr(24) = pjResourceCost2
gResArr(25) = pjResourceCost3
gResArr(26) = pjResourceCost4
gResArr(27) = pjResourceCost5
gResArr(28) = pjResourceCost6
gResArr(29) = pjResourceCost7
gResArr(30) = pjResourceCost8
gResArr(31) = pjResourceCost9
gResArr(32) = pjResourceCost10
gResArr(33) = pjResourceCostPerUse
gResArr(34) = pjResourceCostRateTable
gResArr(35) = pjResourceCostVariance
gResArr(36) = pjResourceCV
gResArr(37) = pjResourceDate1
gResArr(38) = pjResourceDate2
gResArr(39) = pjResourceDate3
gResArr(40) = pjResourceDate4
gResArr(41) = pjResourceDate5
gResArr(42) = pjResourceDate6
gResArr(43) = pjResourceDate7
gResArr(44) = pjResourceDate8
gResArr(45) = pjResourceDate9
gResArr(46) = pjResourceDate10
gResArr(47) = pjResourceDuration1
gResArr(48) = pjResourceDuration2
gResArr(49) = pjResourceDuration3
gResArr(50) = pjResourceDuration4
gResArr(51) = pjResourceDuration5
gResArr(52) = pjResourceDuration6
gResArr(53) = pjResourceDuration7
gResArr(54) = pjResourceDuration8
gResArr(55) = pjResourceDuration9
gResArr(56) = pjResourceDuration10
gResArr(57) = pjResourceEMailAddress
gResArr(58) = pjResourceFinish
gResArr(59) = pjResourceFinish1
gResArr(60) = pjResourceFinish2
gResArr(61) = pjResourceFinish3
gResArr(62) = pjResourceFinish4
gResArr(63) = pjResourceFinish5
gResArr(64) = pjResourceFinish6
gResArr(65) = pjResourceFinish7
gResArr(66) = pjResourceFinish8
gResArr(67) = pjResourceFinish9
gResArr(68) = pjResourceFinish10
gResArr(69) = pjResourceFlag1
gResArr(70) = pjResourceFlag2
gResArr(71) = pjResourceFlag3
gResArr(72) = pjResourceFlag4
gResArr(73) = pjResourceFlag5
gResArr(74) = pjResourceFlag6
gResArr(75) = pjResourceFlag7
gResArr(76) = pjResourceFlag8
gResArr(77) = pjResourceFlag9
gResArr(78) = pjResourceFlag10
gResArr(79) = pjResourceFlag11
gResArr(80) = pjResourceFlag12
gResArr(81) = pjResourceFlag13
gResArr(82) = pjResourceFlag14
gResArr(83) = pjResourceFlag15
gResArr(84) = pjResourceFlag16
gResArr(85) = pjResourceFlag17
gResArr(86) = pjResourceFlag18
gResArr(87) = pjResourceFlag19
gResArr(88) = pjResourceFlag20
gResArr(89) = pjResourceGroup
gResArr(90) = pjResourceHyperlink
gResArr(91) = pjResourceHyperlinkAddress
gResArr(92) = pjResourceHyperlinkHref
gResArr(93) = pjResourceHyperlinkSubAddress
gResArr(94) = pjResourceID
gResArr(95) = pjResourceIndicators
gResArr(96) = pjResourceInitials
gResArr(97) = pjResourceLevelingDelay
gResArr(98) = pjResourceLinkedFields
gResArr(99) = pjResourceMaxUnits
gResArr(100) = pjResourceName
gResArr(101) = pjResourceNotes
gResArr(102) = pjResourceNumber1
gResArr(103) = pjResourceNumber2
gResArr(104) = pjResourceNumber3
gResArr(105) = pjResourceNumber4
gResArr(106) = pjResourceNumber5
gResArr(107) = pjResourceNumber6
gResArr(108) = pjResourceNumber7
gResArr(109) = pjResourceNumber8
gResArr(110) = pjResourceNumber9
gResArr(111) = pjResourceNumber10
gResArr(112) = pjResourceNumber11
gResArr(113) = pjResourceNumber12
gResArr(114) = pjResourceNumber13
gResArr(115) = pjResourceNumber14
gResArr(116) = pjResourceNumber15
gResArr(117) = pjResourceNumber16
gResArr(118) = pjResourceNumber17
gResArr(119) = pjResourceNumber18
gResArr(120) = pjResourceNumber19
gResArr(121) = pjResourceNumber20
gResArr(122) = pjResourceObjects
gResArr(123) = pjResourceOverallocated
gResArr(124) = pjResourceOvertimeCost
gResArr(125) = pjResourceOvertimeRate
gResArr(126) = pjResourceOvertimeWork
gResArr(127) = pjResourcePeakUnits
gResArr(128) = pjResourcePhonetics
gResArr(129) = pjResourceProject
gResArr(130) = pjResourceRegularWork
gResArr(131) = pjResourceRemainingCost
gResArr(132) = pjResourceRemainingOvertimeCost
gResArr(133) = pjResourceRemainingOvertimeWork
gResArr(134) = pjResourceRemainingWork
gResArr(135) = pjResourceResponsePending
gResArr(136) = pjResourceStandardRate
gResArr(137) = pjResourceStart
gResArr(138) = pjResourceStart1
gResArr(139) = pjResourceStart2
gResArr(140) = pjResourceStart3
gResArr(141) = pjResourceStart4
gResArr(142) = pjResourceStart5
gResArr(143) = pjResourceStart6
gResArr(144) = pjResourceStart7
gResArr(145) = pjResourceStart8
gResArr(146) = pjResourceStart9
gResArr(147) = pjResourceStart10
gResArr(148) = pjResourceSV
gResArr(149) = pjResourceTaskSummaryName
gResArr(150) = pjResourceTeamStatusPending
gResArr(151) = pjResourceText1
gResArr(152) = pjResourceText2
gResArr(153) = pjResourceText3
gResArr(154) = pjResourceText4
gResArr(155) = pjResourceText5
gResArr(156) = pjResourceText6
gResArr(157) = pjResourceText7
gResArr(158) = pjResourceText8
gResArr(159) = pjResourceText9
gResArr(160) = pjResourceText10
gResArr(161) = pjResourceText11
gResArr(162) = pjResourceText12
gResArr(163) = pjResourceText13
gResArr(164) = pjResourceText14
gResArr(165) = pjResourceText15
gResArr(166) = pjResourceText16
gResArr(167) = pjResourceText17
gResArr(168) = pjResourceText18
gResArr(169) = pjResourceText19
gResArr(170) = pjResourceText20
gResArr(171) = pjResourceText21
gResArr(172) = pjResourceText22
gResArr(173) = pjResourceText23
gResArr(174) = pjResourceText24
gResArr(175) = pjResourceText25
gResArr(176) = pjResourceText26
gResArr(177) = pjResourceText27
gResArr(178) = pjResourceText28
gResArr(179) = pjResourceText29
gResArr(180) = pjResourceText30
gResArr(181) = pjResourceUniqueID
gResArr(182) = pjResourceUpdateNeeded
gResArr(183) = pjResourceWorkContour
gResArr(184) = pjResourceWorkVariance

gResNamesArr(0) = "Percent Work Complete"
gResNamesArr(1) = "Accrue At"
gResNamesArr(2) = "Actual Cost"
gResNamesArr(3) = "Actual Overtime Cost"
gResNamesArr(4) = "Actual Overtime Work"
gResNamesArr(5) = "Actual Work"
gResNamesArr(6) = "ACWP"
gResNamesArr(7) = "Assignment"
gResNamesArr(8) = "Assignment Delay"
gResNamesArr(9) = "Assignment Units"
gResNamesArr(10) = "Available From"
gResNamesArr(11) = "Available To"
gResNamesArr(12) = "Base Calendar"
gResNamesArr(13) = "Baseline Cost"
gResNamesArr(14) = "Baseline Finish"
gResNamesArr(15) = "Baseline Start"
gResNamesArr(16) = "Baseline Work"
gResNamesArr(17) = "BCWP"
gResNamesArr(18) = "BCWS"
gResNamesArr(19) = "Can Level"
gResNamesArr(20) = "Code"
gResNamesArr(21) = "Confirmed"
gResNamesArr(22) = "Cost"
gResNamesArr(23) = "Cost1"
gResNamesArr(24) = "Cost2"
gResNamesArr(25) = "Cost3"
gResNamesArr(26) = "Cost4"
gResNamesArr(27) = "Cost5"
gResNamesArr(28) = "Cost6"
gResNamesArr(29) = "Cost7"
gResNamesArr(30) = "Cost8"
gResNamesArr(31) = "Cost9"
gResNamesArr(32) = "Cost10"
gResNamesArr(33) = "Cost Per Use"
gResNamesArr(34) = "Cost Rate Table"
gResNamesArr(35) = "Cost Variance"
gResNamesArr(36) = "CV"
gResNamesArr(37) = "Date1"
gResNamesArr(38) = "Date2"
gResNamesArr(39) = "Date3"
gResNamesArr(40) = "Date4"
gResNamesArr(41) = "Date5"
gResNamesArr(42) = "Date6"
gResNamesArr(43) = "Date7"
gResNamesArr(44) = "Date8"
gResNamesArr(45) = "Date9"
gResNamesArr(46) = "Date10"
gResNamesArr(47) = "Duration1"
gResNamesArr(48) = "Duration2"
gResNamesArr(49) = "Duration3"
gResNamesArr(50) = "Duration4"
gResNamesArr(51) = "Duration5"
gResNamesArr(52) = "Duration6"
gResNamesArr(53) = "Duration7"
gResNamesArr(54) = "Duration8"
gResNamesArr(55) = "Duration9"
gResNamesArr(56) = "Duration10"
gResNamesArr(57) = "Email Address"
gResNamesArr(58) = "Finish Date"
gResNamesArr(59) = "Finish1"
gResNamesArr(60) = "Finish2"
gResNamesArr(61) = "Finish3"
gResNamesArr(62) = "Finish4"
gResNamesArr(63) = "Finish5"
gResNamesArr(64) = "Finish6"
gResNamesArr(65) = "Finish7"
gResNamesArr(66) = "Finish8"
gResNamesArr(67) = "Finish9"
gResNamesArr(68) = "Finish10"
gResNamesArr(69) = "Flag1"
gResNamesArr(70) = "Flag2"
gResNamesArr(71) = "Flag3"
gResNamesArr(72) = "Flag4"
gResNamesArr(73) = "Flag5"
gResNamesArr(74) = "Flag6"
gResNamesArr(75) = "Flag7"
gResNamesArr(76) = "Flag8"
gResNamesArr(77) = "Flag9"
gResNamesArr(78) = "Flag10"
gResNamesArr(79) = "Flag11"
gResNamesArr(80) = "Flag12"
gResNamesArr(81) = "Flag13"
gResNamesArr(82) = "Flag14"
gResNamesArr(83) = "Flag15"
gResNamesArr(84) = "Flag16"
gResNamesArr(85) = "Flag17"
gResNamesArr(86) = "Flag18"
gResNamesArr(87) = "Flag19"
gResNamesArr(88) = "Flag20"
gResNamesArr(89) = "Group Name"
gResNamesArr(90) = "Hyperlink"
gResNamesArr(91) = "Hyperlink Address"
gResNamesArr(92) = "Hyperlink Href"
gResNamesArr(93) = "Hyperlink SubAddress"
gResNamesArr(94) = "ID"
gResNamesArr(95) = "Indicators"
gResNamesArr(96) = "Initials"
gResNamesArr(97) = "Leveling Delay"
gResNamesArr(98) = "Linked Fields"
gResNamesArr(99) = "Max Units"
gResNamesArr(100) = "Name"
gResNamesArr(101) = "Notes"
gResNamesArr(102) = "Number1"
gResNamesArr(103) = "Number2"
gResNamesArr(104) = "Number3"
gResNamesArr(105) = "Number4"
gResNamesArr(106) = "Number5"
gResNamesArr(107) = "Number6"
gResNamesArr(108) = "Number7"
gResNamesArr(109) = "Number8"
gResNamesArr(110) = "Number9"
gResNamesArr(111) = "Number10"
gResNamesArr(112) = "Number11"
gResNamesArr(113) = "Number12"
gResNamesArr(114) = "Number13"
gResNamesArr(115) = "Number14"
gResNamesArr(116) = "Number15"
gResNamesArr(117) = "Number16"
gResNamesArr(118) = "Number17"
gResNamesArr(119) = "Number18"
gResNamesArr(120) = "Number19"
gResNamesArr(121) = "Number20"
gResNamesArr(122) = "Objects"
gResNamesArr(123) = "Overallocated"
gResNamesArr(124) = "Overtime Cost"
gResNamesArr(125) = "Overtime Rate"
gResNamesArr(126) = "Overtime Work"
gResNamesArr(127) = "Peak"
gResNamesArr(128) = "Phonetics"
gResNamesArr(129) = "Project"
gResNamesArr(130) = "Regular Work"
gResNamesArr(131) = "Remaining Cost"
gResNamesArr(132) = "Remaining Overtime Cost"
gResNamesArr(133) = "Remaining Overtime Work"
gResNamesArr(134) = "Remaining Work"
gResNamesArr(135) = "Response Pending"
gResNamesArr(136) = "Standard Rate"
gResNamesArr(137) = "Start Date"
gResNamesArr(138) = "Start1"
gResNamesArr(139) = "Start2"
gResNamesArr(140) = "Start3"
gResNamesArr(141) = "Start4"
gResNamesArr(142) = "Start5"
gResNamesArr(143) = "Start6"
gResNamesArr(144) = "Start7"
gResNamesArr(145) = "Start8"
gResNamesArr(146) = "Start9"
gResNamesArr(147) = "Start10"
gResNamesArr(148) = "SV"
gResNamesArr(149) = "Task Summary Name"
gResNamesArr(150) = "Team Status Pending"
gResNamesArr(151) = "Text1"
gResNamesArr(152) = "Text2"
gResNamesArr(153) = "Text3"
gResNamesArr(154) = "Text4"
gResNamesArr(155) = "Text5"
gResNamesArr(156) = "Text6"
gResNamesArr(157) = "Text7"
gResNamesArr(158) = "Text8"
gResNamesArr(159) = "Text9"
gResNamesArr(160) = "Text10"
gResNamesArr(161) = "Text11"
gResNamesArr(162) = "Text12"
gResNamesArr(163) = "Text13"
gResNamesArr(164) = "Text14"
gResNamesArr(165) = "Text15"
gResNamesArr(166) = "Text16"
gResNamesArr(167) = "Text17"
gResNamesArr(168) = "Text18"
gResNamesArr(169) = "Text19"
gResNamesArr(170) = "Text20"
gResNamesArr(171) = "Text21"
gResNamesArr(172) = "Text22"
gResNamesArr(173) = "Text23"
gResNamesArr(174) = "Text24"
gResNamesArr(175) = "Text25"
gResNamesArr(176) = "Text26"
gResNamesArr(177) = "Text27"
gResNamesArr(178) = "Text28"
gResNamesArr(179) = "Text29"
gResNamesArr(180) = "Text30"
gResNamesArr(181) = "Unique ID"
gResNamesArr(182) = "Update Needed"
gResNamesArr(183) = "Work Contour"
gResNamesArr(184) = "Work Variance"
End Sub

Public Function GetTaskFields() As Variant()
    Init
    GetTaskFields = gFieldNamesArr
End Function
Public Function GetResFields() As Variant()
    Init
    GetResFields = gResNamesArr
End Function

Public Function SetProjFile(ByVal piProjFile As String)
    gProjFile = piProjFile
End Function
Public Function GetTaskTree() As String
    Dim lTask As MSProject.Task
    Dim lTaskCount As Long
    Dim lProj As MSProject.Project
    Dim lURL As String
    
    Set gMSProj = CreateObject("MSProject.Project")
    
    gMSProj.Application.FileOpen gProjFile
    gMSProj.Application.DisplayAlerts = False
    gMSProj.Application.Visible = False
    
    Set lProj = gMSProj.Application.ActiveProject
    gMPPName = lProj.Name
    'gMPPName = Mid(gMPPName, 1, Len(gMPPName) - 4)
    
    lTaskCount = 0
    lTaskCount = lProj.Tasks.Count
    
    For Each lTask In lProj.Tasks
        lURL = "tree-view.asp" & "?MSProject=" & gMPPName & "&TaskID=" & lTask.ID
        
        If lTask.OutlineChildren.Count > 0 Then
            gOutHTMLStr = gOutHTMLStr & "dbAdd( true ,'" & lTask.Name & "','" & lURL & "' ," & Val(lTask.OutlineLevel - 1) & ", '' , 0);" & vbCrLf
        Else
            gOutHTMLStr = gOutHTMLStr & "dbAdd( false,'" & lTask.Name & "','" & lURL & "' ," & Val(lTask.OutlineLevel - 1) & ", '' , 0);" & vbCrLf
        End If
    Next
    
    GetTaskTree = gOutHTMLStr
    Set gMSProj = Nothing
End Function

Public Function GetTaskDetails(ByVal piTaskIndex As Long) As String
    Dim lProj As MSProject.Project
    Dim lTaskCount As Long
    Dim lTask As MSProject.Task
    Dim lSubTask As MSProject.Task
    Dim lField As String
    Dim lIdx As Long
    
    Set gMSProj = CreateObject("MSProject.Project")
    
    gMSProj.Application.FileOpen gProjFile
    gMSProj.Application.DisplayAlerts = False
    gMSProj.Application.Visible = False
    
    Set lProj = gMSProj.Application.ActiveProject
    gMPPName = lProj.Name
    'gMPPName = Mid(gMPPName, 1, Len(gMPPName) - 4)
    
    lTaskCount = 0
    lTaskCount = lProj.Tasks.Count
    
    Set lTask = lProj.Tasks(piTaskIndex)

    gOutHTMLStr = "<TR>"
    For lIdx = 0 To UBound(gFieldNamesArr)
        gOutHTMLStr = gOutHTMLStr & "<TD class=tdbgdark><FONT class=whiteboldtext>" & gFieldNamesArr(lIdx) & "</FONT></TD>"
    Next
    gOutHTMLStr = gOutHTMLStr & "</TR>"
    
    For Each lSubTask In lTask.OutlineChildren
        gOutHTMLStr = gOutHTMLStr & "<TR>"
        For lIdx = 0 To UBound(gFieldArr)
            gOutHTMLStr = gOutHTMLStr & "<TD class=tdbglight>" & lSubTask.GetField(gFieldArr(lIdx)) & "</TD>"
        Next
        gOutHTMLStr = gOutHTMLStr & "</TR>"
    Next
    
    gOutHTMLStr = gOutHTMLStr & "<TR>"
    For lIdx = 0 To UBound(gFieldArr)
        gOutHTMLStr = gOutHTMLStr & "<TD class=tdbglight>" & lTask.GetField(gFieldArr(lIdx)) & "</TD>"
    Next
    gOutHTMLStr = gOutHTMLStr & "</TR>"
    
    GetTaskDetails = gOutHTMLStr
    Set gMSProj = Nothing
End Function

