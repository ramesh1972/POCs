<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">

<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">

<link rel="stylesheet" title="Default Style" href="styles/default/main.css" type="text/css">
<link rel="stylesheet" href="styles/default/xultu.css" type="text/css">


<link rel="stylesheet" href="styles/default/xultu-print.css" type="text/css" media="print">


<link rel="home"   href="http://www.xulplanet.com/"            title="http://www.XulPlanet.com/">
<link rel="search" href="http://www.xulplanet.com/cgi-bin/search/search.cgi" title="Search XulPlanet">
<link rel="author" href="http://www.xulplanet.com/ndeakin" title="Neil Deakin">
 <link rel="up" href="http://www.xulplanet.com/tutorials/" title="Up"> 
 <link rel="first" href="intro.html" title="First"> 
 <link rel="last" href="end.html" title="Last"> 

 <link rel="prev" href="advtrees.html"> 
 <link rel="next" href="treeview.html"> 

<meta name="Description" content="Step by step tutorial of the XML User Interface Language">

<title>XulPlanet.com - Tree Selection</title>

</head>
<body>

<div id="header">
  <a href="http://www.xulplanet.com/">
    <img id="logo" src="images/xulplanet.png" width="215" height="65" alt="XUL Planet">
  </a>

<div id="locationlinks">
  <a href="http://www.xulplanet.com/">Home</a> &gt;

  <a href="http://www.xulplanet.com/tutorials/">Tutorials</a> :


  <a href="index.html">XUL Tutorial</a> :



 8.3 - Tree Selection 
</div>



</div>



<hr class="edgesplit">

<div id="sidebar">

<div id="search">
  <form action="/cgi-bin/search/search.cgi" method="get">
    Search:<br>
    <input id="search-box" name="Terms" type="text">
    <input type="submit" value="Go">
  </form>
</div>

<hr>

<ul class="sidebar-section-links">
  <li><a href="http://www.xulplanet.com/tutorials/xultu/allofit.zip">Single Document Version</a></li>
  <li><a href="http://www.xulplanet.com/tutorials/xultu/xultu.zip">Download the XUL Tutorial</a><br></li>
  <li><a href="http://www.xulplanet.com/references/elemref/">Element Reference</a></li>
  <li><a href="http://www.xulplanet.com/references/elemref/quickref.html">Quick Reference</a><br></li>
  <li><a href="keyref.html">Key Code Reference</a></li>
  <li><a href="templateex.html">Template Syntax Examples</a></li>
</ul>

<hr>



<OL id="sidebar-docs-index">
  <LI class="sidebar-section-title">Introduction
  <OL>
    <LI> <A HREF="intro.html">Introduction</A></LI>
    <LI> <A HREF="xulfile.html">XUL Structure</A></LI>
    <LI> <A HREF="chromeurl.html">The Chrome URL</A></LI>
    <LI> <A HREF="packaging.html">Contents.rdf Files</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">Simple Elements
  <OL>
    <LI> <A HREF="window.html">Creating a Window</A></LI>
    <LI> <A HREF="buttons.html">Adding Buttons</A></LI>
    <LI> <A HREF="textimage.html">Adding Labels and Images</A></LI>
    <LI> <A HREF="inputs.html">Input Controls</A></LI>
    <LI> <A HREF="lists.html">List Controls</A></LI>
    <LI> <A HREF="progress.html">Progress Meters</A></LI>
    <LI> <A HREF="htmlelem.html">Adding HTML Elements</A></LI>
    <LI> <A HREF="springs.html">Using Spacers</A></LI>
    <LI> <A HREF="advbtns.html">More Button Features</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">The Box Model
  <OL>
    <LI> <A HREF="boxes.html">The Box Model</A></LI>
    <LI> <A HREF="boxstyle.html">Element Positioning</A></LI>
    <LI> <A HREF="boxdet.html">Box Model Details</A></LI>
    <LI> <A HREF="titledbox.html">Groupboxes</A></LI>
    <LI> <A HREF="boxfinal.html">Adding More Elements</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">More Layout Elements
  <OL>
    <LI> <A HREF="stacks.html">Stacks and Decks</A></LI>
    <LI> <A HREF="bulletins.html">Stack Positioning</A></LI>
    <LI> <A HREF="tabpanel.html">Tabboxes</A></LI>
    <LI> <A HREF="grids.html">Grids</A></LI>
    <LI> <A HREF="cpanels.html">Content Panels</A></LI>
    <LI> <A HREF="splitter.html">Splitters</A></LI>
    <LI> <A HREF="scroll.html">Scroll Bars</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">Toolbars and Menus
  <OL>
    <LI> <A HREF="toolbar.html">Toolbars</A></LI>
    <LI> <A HREF="menubar.html">Simple Menu Bars</A></LI>
    <LI> <A HREF="advmenu.html">More Menu Features</A></LI>
    <LI> <A HREF="popups.html">Popup Menus</A></LI>
    <LI> <A HREF="menuscroll.html">Scrolling Menus</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">Events and Scripts
  <OL>
    <LI> <A HREF="events.html">Adding Event Handlers</A></LI>
    <LI> <A HREF="advevents.html">More Event Handlers</A></LI>
    <LI> <A HREF="keyshort.html">Keyboard Shortcuts</A></LI>
    <LI> <A HREF="focus.html">Focus and Selection</A></LI>
    <LI> <A HREF="commands.html">Commands</A></LI>
    <LI> <A HREF="commandupdate.html">Updating Commands</A></LI>
    <LI> <A HREF="broadob.html">Broadcasters and Observers</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">Document Object Model
  <OL>
    <LI> <A HREF="dom.html">Document Object Model</A></LI>
    <LI> <A HREF="dommodify.html">Modifying a XUL Interface</A></LI>
    <LI> <A HREF="domlists.html">Manipulating Lists</A></LI>
    <LI> <A HREF="boxobject.html">Box Objects</A></LI>
    <LI> <A HREF="xpcom.html">XPCOM Interfaces</A></LI>
    <LI> <A HREF="xpcomex.html">XPCOM Examples</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">Trees
  <OL>
    <LI> <A HREF="trees.html">Trees</A></LI>
    <LI> <A HREF="advtrees.html">More Tree Features</A></LI>
    <LI> <SPAN CLASS="currentpage">Tree Selection</SPAN></LI>
    <LI> <A HREF="treeview.html">Custom Tree Views</A></LI>
    <LI> <A HREF="treeviewdet.html">Tree View Details</A></LI>
    <LI> <A HREF="treeboxobject.html">Tree Box Objects</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">RDF and Templates
  <OL>
    <LI> <A HREF="intrordf.html">Introduction to RDF</A></LI>
    <LI> <A HREF="templates.html">Templates</A></LI>
    <LI> <A HREF="treetempl.html">Trees and Templates</A></LI>
    <LI> <A HREF="datasrc.html">RDF Datasources</A></LI>
    <LI> <A HREF="advrules.html">Advanced Rules</A></LI>
    <LI> <A HREF="persist.html">Persistent Data</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">Skins and Locales
  <OL>
    <LI> <A HREF="style.html">Adding Style Sheets</A></LI>
    <LI> <A HREF="treestyle.html">Styling a Tree</A></LI>
    <LI> <A HREF="defskin.html">Modifying the Default Skin</A></LI>
    <LI> <A HREF="cskin.html">Creating a Skin</A></LI>
    <LI> <A HREF="locale.html">Localization</A></LI>
    <LI> <A HREF="locprops.html">Property Files</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">Bindings
  <OL>
    <LI> <A HREF="introxbl.html">Introduction to XBL</A></LI>
    <LI> <A HREF="xblcontent.html">Anonymous Content</A></LI>
    <LI> <A HREF="xblatin.html">XBL Attribute Inheritance</A></LI>
    <LI> <A HREF="xblprops.html">Adding Properties</A></LI>
    <LI> <A HREF="xblmethods.html">Adding Methods</A></LI>
    <LI> <A HREF="xblevents.html">Adding Event Handlers</A></LI>
    <LI> <A HREF="xblinherit.html">XBL Inheritance</A></LI>
    <LI> <A HREF="xblex.html">XBL Example</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">Specialized Window Types
  <OL>
    <LI> <A HREF="featwin.html">Features of a Window</A></LI>
    <LI> <A HREF="dialogs.html">Creating Dialogs</A></LI>
    <LI> <A HREF="filedialog.html">Open and Save Dialogs</A></LI>
    <LI> <A HREF="wizard.html">Creating a Wizard</A></LI>
    <LI> <A HREF="advwiz.html">More Wizards</A></LI>
    <LI> <A HREF="overlay.html">Overlays</A></LI>
    <LI> <A HREF="crosspov.html">Cross Package Overlays</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">Installation
  <OL>
    <LI> <A HREF="xpinstall.html">Creating an Installer</A></LI>
    <LI> <A HREF="xpiscript.html">Install Scripts</A></LI>
    <LI> <A HREF="xpiadv.html">Additional Install Features</A></LI>
  </OL>
</OL>

</div>



<div id="content">

<div class="navlinks-pnc">

  <a class="prevlink" title="8.2 - More Tree Features"
     href="advtrees.html">Previous</a>


  <a class="nextlink" title="8.4 - Custom Tree Views"
     href="treeview.html">Next</a>

</div>

<div class="xultu-content">

<h2>Tree Selection</h2>

<P>
The section will describe how to get and set the selected items in
a tree.
</P>

<H3>Getting the Selected Tree Items</H3>

<P>
Each <A CLASS="tag" HREF="elemref/ref_treeitem.html">treeitem</A> element in a tree may be selected
individually. If you add the <SPAN CLASS="attrib">seltype</SPAN> attribute
to the tree, set to the value <SPAN CLASS="aval">single</SPAN>, the user
may only select one row at a time. Otherwise, the user may select multiple
rows, which will not necessarily be contiguous. The tree provides a number
of functions which can be used to determine whether an item is selected.
</P>

<P>
First, let's see how we can determine when an item is selected. The
<SPAN CLASS="attrib">onselect</SPAN> event handler may be added to the
<A CLASS="tag" HREF="elemref/ref_tree.html">tree</A> element. When the user selects an item
from the tree, the event handler is called. The user may also change the
selection by using the cursor keys. If the user holds down the cursor key
to rapidly scroll through the items, the event handler is not called until
the user stops. This results in a performance improvement. This also means
that the highlight will appear on several items even though the select event
is never fired for those items.
</P>

<P>
The syntax of the <SPAN CLASS="attrib">onselect</SPAN> event handler is
shown below.
</P>


<DIV CLASS="sample"><PRE>&lt;tree id="treeset" onselect="alert('You selected something!');"&gt;</PRE></DIV>



<P>
The tree has a property <SPAN CLASS="attrib">currentIndex</SPAN>, which
can be used to get the currently selected item, where the first row is 0.
</P>

<P>
Child items are included in the count just after their parents. This means
that if there are 3 top-level items and each has two child items, there
will be a total of 9 items. The first item (at index 0) will be the first
top-level item. The next item at index 1 will be its first child. The
second child will be at index 2 and the second parent item will be at
position 3 and so on.
</P>

<IMG SRC="images/seltree1.jpg" ALIGN="RIGHT" ALT="" WIDTH=278 HEIGHT=282>

<P>
In the image to the right, there are eight rows displayed, of which two
are selected. The first selected row has an index of 4 and the second
has an index of 7. The rows that are not displayed are not included in
the index count.
</P>

<P>
For trees that allow multiple selection, getting the list of selected rows
is a bit more complicated. The tree's view has a selection property which holds
information about the selected rows. This selection will be a
<a href="http://xulplanet.com/references/objref/TreeSelection.html">TreeSelection</a>
object. The view doesn't need to implement this object itself, the tree will assign
a selection object to the view's selection property when the view is attached
to a tree. From the tree, you can get the selection using the tree's
<SPAN CLASS="attrib">view</SPAN> property and then retrieve the view's
<SPAN CLASS="attrib">selection</SPAN> property. You can use the methods of the
selection object to retrieve the set of selected items or modify the selection.
</P>

<P>
Because the selected items in a multiple selection tree are not necessarily
contiguous, you can retrieve each block of contigous selections using the
getRangeCount and getRangeAt functions. The first function returns the
number of selection ranges there are. If only one value is selected, this
value will be 1. You would then write a loop for the number of ranges, calling
getRangeAt to get the actual indices of the start and end of the range.
</P>

<P>
The getRangeAt function takes three arguments. The first is the range index.
The second is an object which will be filled in by the function with the
index of the first selected item. The third argument is an object which will
be filled in with the index of the last selected item.
</P>

<P>
For example:
</P>


<DIV CLASS="sample"><PRE>
var start = new Object();
var end = new Object();
var numRanges = tree.view.selection.getRangeCount();

for (var t=0; t&lt;numRanges; t++){
  tree.view.selection.getRangeAt(t,start,end);
  for (var v=start.value; v&lt;=end.value; v++){
    alert("Item "+v+" is selected.");
  }
}</PRE></DIV>



<P>
We create two objects called 'start' and 'end'. Then, we iterate over the set
of ranges, the number of which is returned by the getRangeCount function.
The getRangeAt function is called passing the range index and the start and
end objects. This function will fill in the start and end indicies by
assigning them to the 'value' property. So if the first range is from the third
item to the seventh item, 'start.value' will be 2 (remember that indices start
with 0, so we subtract one.) and 'end.value' will be 6. An alert is displayed
for each index.
</P>

<P>
If you just want to find out if a specific row is selected, use can use the
isSelected function. It takes a row index as an argument and returns true if
that row is selected.
</P>


<DIV CLASS="sample"><PRE>
alert(tree.view.selection.isSelected(3));</PRE></DIV>



<H3>Modifying the Tree Selection</H3>

<P>
The selection object has a number of functions which may be used to change the
selection. The simplest function is the select function, which deselects any
rows that are currently selected and selects one specific row. For example, the
following code will select the row at index 5:
</P>


<DIV CLASS="sample"><PRE>
tree.view.selection.select(5);</PRE></DIV>



<P>
Note that you should not just change the tree's currentIndex property to change the
selection. Instead, you should use the selection's select function as in the example
above. You can select all rows with the selectAll function. Note that rows nested
inside containers that are not open will not be selected. Naturally, this will only
have any effect for trees that use multiple selection. There is also a clearSelection
function to clear the selection, and an invertSelection function to reverse the
selection, that is, deselect all selected rows and select all unselected rows.
</P>

<P>
To select specific rows, use the rangedSelect function which selects all rows in between
two indices. Here is an example which selects rows between index 2 and 7. Note that rows
2 and 7 will also be selected.
</P>


<DIV CLASS="sample"><PRE>
tree.view.selection.rangedSelect(2,7,true);</PRE></DIV>



<P>
The last argument indicates whether to add to the current selection or not. If true,
the range will be added to the existing selection. If false, all existing selected rows
will be deselected first. Finally, the clearRange function may be used to deselect a
range of rows, leaving rows outside the range unaffected.
</P>


<DIV CLASS="sample"><PRE>
tree.view.selection.clearRange(2,7);</PRE></DIV>



<HR>
<P>
<A HREF="treeview.html">(Next)</A>
Next, we'll find out how to create a custom view for a tree.

</P>
</div>

<div class="navlinks-pnc">

  <a class="prevlink" title="8.2 - More Tree Features"
     href="advtrees.html">Previous</a>


  <a class="nextlink" title="8.4 - Custom Tree Views"
     href="treeview.html">Next</a>

</div>

</div>

<hr class="edgesplit">

<div id="copyblock">
  Copyright (C) 1999 - 2004 XulPlanet.com
</div>

</body>
</html>

