<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">

<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">

<link rel="stylesheet" title="Default Style" href="styles/default/main.css" type="text/css">
<link rel="stylesheet" href="styles/default/xultu.css" type="text/css">


<link rel="stylesheet" href="styles/default/xultu-print.css" type="text/css" media="print">


<link rel="home"   href="http://www.xulplanet.com/"            title="http://www.XulPlanet.com/">
<link rel="search" href="http://www.xulplanet.com/cgi-bin/search/search.cgi" title="Search XulPlanet">
<link rel="author" href="http://www.xulplanet.com/ndeakin" title="Neil Deakin">
 <link rel="up" href="http://www.xulplanet.com/tutorials/" title="Up"> 
 <link rel="first" href="intro.html" title="First"> 
 <link rel="last" href="end.html" title="Last"> 

 <link rel="prev" href="seltree.html"> 
 <link rel="next" href="treeviewdet.html"> 

<meta name="Description" content="Step by step tutorial of the XML User Interface Language">

<title>XulPlanet.com - Custom Tree Views</title>

</head>
<body>

<div id="header">
  <a href="http://www.xulplanet.com/">
    <img id="logo" src="images/xulplanet.png" width="215" height="65" alt="XUL Planet">
  </a>

<div id="locationlinks">
  <a href="http://www.xulplanet.com/">Home</a> &gt;

  <a href="http://www.xulplanet.com/tutorials/">Tutorials</a> :


  <a href="index.html">XUL Tutorial</a> :



 8.4 - Custom Tree Views 
</div>



</div>



<hr class="edgesplit">

<div id="sidebar">

<div id="search">
  <form action="/cgi-bin/search/search.cgi" method="get">
    Search:<br>
    <input id="search-box" name="Terms" type="text">
    <input type="submit" value="Go">
  </form>
</div>

<hr>

<ul class="sidebar-section-links">
  <li><a href="http://www.xulplanet.com/tutorials/xultu/allofit.zip">Single Document Version</a></li>
  <li><a href="http://www.xulplanet.com/tutorials/xultu/xultu.zip">Download the XUL Tutorial</a><br></li>
  <li><a href="http://www.xulplanet.com/references/elemref/">Element Reference</a></li>
  <li><a href="http://www.xulplanet.com/references/elemref/quickref.html">Quick Reference</a><br></li>
  <li><a href="keyref.html">Key Code Reference</a></li>
  <li><a href="templateex.html">Template Syntax Examples</a></li>
</ul>

<hr>



<OL id="sidebar-docs-index">
  <LI class="sidebar-section-title">Introduction
  <OL>
    <LI> <A HREF="intro.html">Introduction</A></LI>
    <LI> <A HREF="xulfile.html">XUL Structure</A></LI>
    <LI> <A HREF="chromeurl.html">The Chrome URL</A></LI>
    <LI> <A HREF="packaging.html">Contents.rdf Files</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">Simple Elements
  <OL>
    <LI> <A HREF="window.html">Creating a Window</A></LI>
    <LI> <A HREF="buttons.html">Adding Buttons</A></LI>
    <LI> <A HREF="textimage.html">Adding Labels and Images</A></LI>
    <LI> <A HREF="inputs.html">Input Controls</A></LI>
    <LI> <A HREF="lists.html">List Controls</A></LI>
    <LI> <A HREF="progress.html">Progress Meters</A></LI>
    <LI> <A HREF="htmlelem.html">Adding HTML Elements</A></LI>
    <LI> <A HREF="springs.html">Using Spacers</A></LI>
    <LI> <A HREF="advbtns.html">More Button Features</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">The Box Model
  <OL>
    <LI> <A HREF="boxes.html">The Box Model</A></LI>
    <LI> <A HREF="boxstyle.html">Element Positioning</A></LI>
    <LI> <A HREF="boxdet.html">Box Model Details</A></LI>
    <LI> <A HREF="titledbox.html">Groupboxes</A></LI>
    <LI> <A HREF="boxfinal.html">Adding More Elements</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">More Layout Elements
  <OL>
    <LI> <A HREF="stacks.html">Stacks and Decks</A></LI>
    <LI> <A HREF="bulletins.html">Stack Positioning</A></LI>
    <LI> <A HREF="tabpanel.html">Tabboxes</A></LI>
    <LI> <A HREF="grids.html">Grids</A></LI>
    <LI> <A HREF="cpanels.html">Content Panels</A></LI>
    <LI> <A HREF="splitter.html">Splitters</A></LI>
    <LI> <A HREF="scroll.html">Scroll Bars</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">Toolbars and Menus
  <OL>
    <LI> <A HREF="toolbar.html">Toolbars</A></LI>
    <LI> <A HREF="menubar.html">Simple Menu Bars</A></LI>
    <LI> <A HREF="advmenu.html">More Menu Features</A></LI>
    <LI> <A HREF="popups.html">Popup Menus</A></LI>
    <LI> <A HREF="menuscroll.html">Scrolling Menus</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">Events and Scripts
  <OL>
    <LI> <A HREF="events.html">Adding Event Handlers</A></LI>
    <LI> <A HREF="advevents.html">More Event Handlers</A></LI>
    <LI> <A HREF="keyshort.html">Keyboard Shortcuts</A></LI>
    <LI> <A HREF="focus.html">Focus and Selection</A></LI>
    <LI> <A HREF="commands.html">Commands</A></LI>
    <LI> <A HREF="commandupdate.html">Updating Commands</A></LI>
    <LI> <A HREF="broadob.html">Broadcasters and Observers</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">Document Object Model
  <OL>
    <LI> <A HREF="dom.html">Document Object Model</A></LI>
    <LI> <A HREF="dommodify.html">Modifying a XUL Interface</A></LI>
    <LI> <A HREF="domlists.html">Manipulating Lists</A></LI>
    <LI> <A HREF="boxobject.html">Box Objects</A></LI>
    <LI> <A HREF="xpcom.html">XPCOM Interfaces</A></LI>
    <LI> <A HREF="xpcomex.html">XPCOM Examples</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">Trees
  <OL>
    <LI> <A HREF="trees.html">Trees</A></LI>
    <LI> <A HREF="advtrees.html">More Tree Features</A></LI>
    <LI> <A HREF="seltree.html">Tree Selection</A></LI>
    <LI> <SPAN CLASS="currentpage">Custom Tree Views</SPAN></LI>
    <LI> <A HREF="treeviewdet.html">Tree View Details</A></LI>
    <LI> <A HREF="treeboxobject.html">Tree Box Objects</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">RDF and Templates
  <OL>
    <LI> <A HREF="intrordf.html">Introduction to RDF</A></LI>
    <LI> <A HREF="templates.html">Templates</A></LI>
    <LI> <A HREF="treetempl.html">Trees and Templates</A></LI>
    <LI> <A HREF="datasrc.html">RDF Datasources</A></LI>
    <LI> <A HREF="advrules.html">Advanced Rules</A></LI>
    <LI> <A HREF="persist.html">Persistent Data</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">Skins and Locales
  <OL>
    <LI> <A HREF="style.html">Adding Style Sheets</A></LI>
    <LI> <A HREF="treestyle.html">Styling a Tree</A></LI>
    <LI> <A HREF="defskin.html">Modifying the Default Skin</A></LI>
    <LI> <A HREF="cskin.html">Creating a Skin</A></LI>
    <LI> <A HREF="locale.html">Localization</A></LI>
    <LI> <A HREF="locprops.html">Property Files</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">Bindings
  <OL>
    <LI> <A HREF="introxbl.html">Introduction to XBL</A></LI>
    <LI> <A HREF="xblcontent.html">Anonymous Content</A></LI>
    <LI> <A HREF="xblatin.html">XBL Attribute Inheritance</A></LI>
    <LI> <A HREF="xblprops.html">Adding Properties</A></LI>
    <LI> <A HREF="xblmethods.html">Adding Methods</A></LI>
    <LI> <A HREF="xblevents.html">Adding Event Handlers</A></LI>
    <LI> <A HREF="xblinherit.html">XBL Inheritance</A></LI>
    <LI> <A HREF="xblex.html">XBL Example</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">Specialized Window Types
  <OL>
    <LI> <A HREF="featwin.html">Features of a Window</A></LI>
    <LI> <A HREF="dialogs.html">Creating Dialogs</A></LI>
    <LI> <A HREF="filedialog.html">Open and Save Dialogs</A></LI>
    <LI> <A HREF="wizard.html">Creating a Wizard</A></LI>
    <LI> <A HREF="advwiz.html">More Wizards</A></LI>
    <LI> <A HREF="overlay.html">Overlays</A></LI>
    <LI> <A HREF="crosspov.html">Cross Package Overlays</A></LI>
  </OL>
  </LI>
  <LI class="sidebar-section-title">Installation
  <OL>
    <LI> <A HREF="xpinstall.html">Creating an Installer</A></LI>
    <LI> <A HREF="xpiscript.html">Install Scripts</A></LI>
    <LI> <A HREF="xpiadv.html">Additional Install Features</A></LI>
  </OL>
</OL>

</div>



<div id="content">

<div class="navlinks-pnc">

  <a class="prevlink" title="8.3 - Tree Selection"
     href="seltree.html">Previous</a>


  <a class="nextlink" title="8.5 - Tree View Details"
     href="treeviewdet.html">Next</a>

</div>

<div class="xultu-content">

<h2>Custom Tree Views</h2>

<P>
The tree view holds the data to be displayed in the tree,
</P>

<H3>Creating a Custom View</H3>

<P>
So far, we have only been using the built-in content tree view. In this section,
we will look at creating a custom view. This is necessary when the amount of data
is large or arranged in a complex way. For instance, it just wouldn't be viable
performance-wise to use treeitems when there are several thousand rows. You might
also implement a custom view when you want to perform computations on the data
to be displayed. Since the view can store and retrieve the data in the most suitable
manner for the kind of data used, the tree can be used even when there are hundreds
of thousands of rows to be displayed.
</P>

<P>
To implement a custom view, you will need to create an object which implements the
<A HREF="http://xulplanet.com/references/xpcomref/ifaces/nsITreeView.html">nsITreeView</A>
interface. You can create these objects in JavaScript, but you will need a separate
object for each tree. Naturally, since a custom tree view is being used, the content
tree view will not be used, so the treeitem, treerow, and treecell elements will have
no purpose since the custom view will get its data from elsewhere. Thus, you can just
leave the <A CLASS="tag" HREF="elemref/ref_treechildren.html">treechildren</A> element empty. The following example
shows this:
</P>


<DIV CLASS="sample"><PRE>&lt;tree id="my-tree" flex="1"&gt;
  &lt;treecols&gt;
    &lt;treecol id="namecol" label="Name" flex="1"/&gt;
    &lt;treecol id="datecol" label="Date" flex="1"/&gt;
  &lt;/treecols&gt;
  &lt;treechildren/&gt;
&lt;/tree&gt;</PRE></DIV>



<P>
To assign data to be displayed in the tree, the view object needs to be created
which is used to indicate the value of each cell, the total number of rows plus
other optional information. The tree will call methods of the view to get the
information that it needs to display.
</P>

<P>
In general, although the tree view has thirty or so functions that may be
implemented, you only need to implement the ones that the tree will call.
Three methods that you should implement are listed below.
</P>

<UL>
  <LI><DIV CLASS="attrib">rowCount</DIV>
      This property should be set to the total number of rows in the tree.
  </LI>
  <LI><DIV CLASS="attrib">getCellText( row , column )</DIV>
      This method should return the text contents at the specified row and column.
      This will be called to display data for each cell. The rows are supplied
      as numeric values starting at 0. The columns are supplied as the values of
      the <SPAN CLASS="attrib">id</SPAN> attribute on the columns. In Mozilla 1.8
      and later, the column will instead be a TreeColumn object.
  </LI>
  <LI><DIV CLASS="attrib">setTree( tree )</DIV>
      This method is called once to set the tree element on the view.
  </LI>
</UL>

<P>
Here is an example of defining such as object, which can be called whatever you want:
</P>


<DIV CLASS="sample"><PRE>var treeView = {
    rowCount : 10000,
    getCellText : function(row,column){
      if (column == "namecol") return "Row "+row;
      else return "February 18";
    },
    setTree: function(treebox){ this.treebox = treebox; },
    isContainer: function(row){ return false; },
    isSeparator: function(row){ return false; },
    isSorted: function(row){ return false; },
    getLevel: function(row){ return 0; },
    getImageSrc: function(row,col){ return null; },
    getRowProperties: function(row,props){},
    getCellProperties: function(row,col,props){},
    getColumnProperties: function(colid,col,props){}
};</PRE></DIV>



<P>
The functions in the example not described above do not need to
perform any action, but they must be implemented as the tree calls
them to gather additional information.
</P>

<P>
This example can be used for an tree with 10000 rows. The contents of the cells
in the first column will be set to the text 'Row X' where X is the row number. The
contents of the cells in the second column will be set to 'February 18'. The if
statement in the function getCellText compares the column to the text 'namecol'.
This text 'namecol' corresponds to the <SPAN CLASS="attrib">id</SPAN> of the first
<A CLASS="tag" HREF="elemref/ref_treecol.html">treecol</A> in the example above. This example is very simple
of course -- in reality you would have more complex data in each cell.
</P>

<P>
The final step is to associate the view object with the tree. The tree has a
property <SPAN CLASS="attrib">view</SPAN>, which can be assigned to the view
object declared above. We can assign a value to this property at any time to set
or change the view.
</P>


<DIV CLASS="sample"><PRE>function setView()
{
    document.getElementById('my-tree').view = treeView;
}</PRE></DIV>



<P>
The following presents the example together. An inline script has been used here
to simplify the example. Normally, you would put the script in an external script
file.
</P>


Example 8.4.1:
<A HREF='examples/ex_treeview_1.xul.txt'>Source</A>
<DIV CLASS="examplec"><PRE>&lt;?xml version="1.0"?&gt;

&lt;?xml-stylesheet href="chrome://global/skin/" type="text/css"?&gt;

&lt;window title="Tree Example" id="tree-window"
   xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"
   onload="setView();"&gt;

&lt;script&gt;
var treeView = {
    rowCount : 10000,
    getCellText : function(row,column){
      if (column == "namecol") return "Row "+row;
      else return "February 18";
    },
    setTree: function(treebox){ this.treebox = treebox; },
    isContainer: function(row){ return false; },
    isSeparator: function(row){ return false; },
    isSorted: function(row){ return false; },
    getLevel: function(row){ return 0; },
    getImageSrc: function(row,col){ return null; },
    getRowProperties: function(row,props){},
    getCellProperties: function(row,col,props){},
    getColumnProperties: function(colid,col,props){}
};

function setView()
{
    document.getElementById('my-tree').view=treeView;
}
&lt;/script&gt;

&lt;tree id="my-tree" flex="1"&gt;
  &lt;treecols&gt;
    &lt;treecol id="namecol" label="Name" flex="1"/&gt;
    &lt;treecol id="datecol" label="Date" flex="1"/&gt;
  &lt;/treecols&gt;
  &lt;treechildren/&gt;
&lt;/tree&gt;

&lt;/window&gt;</PRE></DIV>



<P>
<IMG SRC="images/treeview1.jpg" ALIGN="right" ALT="" WIDTH=242 HEIGHT=162>
</P>

<P>
In the image, you can see two columns, each with data taken from the getCellText
function. The setView function has been called in the onload handler for the
window, but you could also set the view later if you wish. You can change the view
at any time.
</P>

<P>
One thing to note is that the getCellText function is only called when necessary
to display the contents. In the 10000 row example above, getCellText is only called
for the cells that are currently displayed. In the image, only seven rows are
displayed, the last only partially, so getCellText will be called only 14 times, one
for each row and column. It is called for other rows when the user scrolls through
them. This makes the tree much more efficient.
</P>

<P>
Note that the view object is also available for trees using the built-in content view.
You can use this to get the cell labels and other information.
</P>

<P>
The <a href="http://www.xulplanet.com/references/xpcomref/ifaces/nsITreeView.html">
nsITreeView interface</a> lists all of the properties and methods that you can
implement for the tree view. We'll look at more of these in the next section.
</P>

<HR>
<P>
<A HREF="treeviewdet.html">(Next)</A>
Next, we'll look at RDF which can be used to automatically populate trees.

</P>
<P>

Examples:
  <A HREF='examples/ex_treeview_1.xul.txt'>8.4.1</A>
</P>
</div>

<div class="navlinks-pnc">

  <a class="prevlink" title="8.3 - Tree Selection"
     href="seltree.html">Previous</a>


  <a class="nextlink" title="8.5 - Tree View Details"
     href="treeviewdet.html">Next</a>

</div>

</div>

<hr class="edgesplit">

<div id="copyblock">
  Copyright (C) 1999 - 2004 XulPlanet.com
</div>

</body>
</html>

